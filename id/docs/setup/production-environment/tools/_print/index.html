<!doctype html><html lang=id class=no-js>
<head>
<meta name=ROBOTS content="NOINDEX, NOFOLLOW">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JPP6RFM2BP"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-JPP6RFM2BP')</script>
<link rel=alternate hreflang=en href=https://kubernetes.io/docs/setup/production-environment/tools/>
<link rel=alternate hreflang=zh href=https://kubernetes.io/zh/docs/setup/production-environment/tools/>
<link rel=alternate hreflang=ko href=https://kubernetes.io/ko/docs/setup/production-environment/tools/>
<link rel=alternate hreflang=ja href=https://kubernetes.io/ja/docs/setup/production-environment/tools/>
<link rel=alternate hreflang=fr href=https://kubernetes.io/fr/docs/setup/production-environment/tools/>
<link rel=alternate hreflang=uk href=https://kubernetes.io/uk/docs/setup/production-environment/tools/>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.87.0">
<link rel=canonical type=text/html href=https://kubernetes.io/id/docs/setup/production-environment/tools/>
<link rel="shortcut icon" type=image/png href=/images/favicon.png>
<link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180>
<link rel=manifest href=/manifest.webmanifest>
<link rel=apple-touch-icon href=/images/kubernetes-192x192.png>
<title>Menginstal Kubernetes dengan perkakas penyebaran | Kubernetes</title><meta property="og:title" content="Menginstal Kubernetes dengan perkakas penyebaran">
<meta property="og:description" content="Orkestrasi Kontainer dengan Skala Produksi">
<meta property="og:type" content="website">
<meta property="og:url" content="https://kubernetes.io/id/docs/setup/production-environment/tools/"><meta property="og:site_name" content="Kubernetes">
<meta itemprop=name content="Menginstal Kubernetes dengan perkakas penyebaran">
<meta itemprop=description content="Orkestrasi Kontainer dengan Skala Produksi"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Menginstal Kubernetes dengan perkakas penyebaran">
<meta name=twitter:description content="Orkestrasi Kontainer dengan Skala Produksi">
<link href=/scss/main.css rel=stylesheet>
<script src=/js/jquery-3.3.1.min.js integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin=anonymous></script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","url":"https://kubernetes.io","logo":"https://kubernetes.io/images/favicon.png"}</script>
<meta name=theme-color content="#326ce5">
<link rel=stylesheet href=/css/feature-states.css>
<meta name=description content>
<meta property="og:description" content>
<meta name=twitter:description content>
<meta property="og:url" content="https://kubernetes.io/id/docs/setup/production-environment/tools/">
<meta property="og:title" content="Menginstal Kubernetes dengan perkakas penyebaran">
<meta name=twitter:title content="Menginstal Kubernetes dengan perkakas penyebaran">
<meta name=twitter:image content="https://kubernetes.io/images/favicon.png">
<meta name=twitter:image:alt content="Kubernetes">
<meta property="og:image" content="/images/kubernetes-horizontal-color.png">
<meta property="og:type" content="article">
<script src=/js/script.js></script>
</head>
<body class=td-section>
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar" data-auto-burger=primary>
<a class=navbar-brand href=/id/></a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-2 mb-lg-0">
<a class="nav-link active" href=/id/docs/>Dokumentasi</a>
</li>
<li class="nav-item mr-2 mb-lg-0">
<a class=nav-link href=/id/community/>Komunitas</a>
</li>
<li class="nav-item mr-2 mb-lg-0">
<a class=nav-link href=/id/case-studies/>Studi kasus</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
Versi
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/releases>Release Information</a>
<a class=dropdown-item href=https://kubernetes.io/id/docs/setup/production-environment/tools/>v1.27</a>
<a class=dropdown-item href=https://v1-26.docs.kubernetes.io/id/docs/setup/production-environment/tools/>v1.26</a>
<a class=dropdown-item href=https://v1-25.docs.kubernetes.io/id/docs/setup/production-environment/tools/>v1.25</a>
<a class=dropdown-item href=https://v1-24.docs.kubernetes.io/id/docs/setup/production-environment/tools/>v1.24</a>
<a class=dropdown-item href=https://v1-23.docs.kubernetes.io/id/docs/setup/production-environment/tools/>v1.23</a>
</div>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdownMenuLink role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
Bahasa Indonesia
</a>
<div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/docs/setup/production-environment/tools/>English</a>
<a class=dropdown-item href=/zh/docs/setup/production-environment/tools/>中文 Chinese</a>
<a class=dropdown-item href=/ko/docs/setup/production-environment/tools/>한국어 Korean</a>
<a class=dropdown-item href=/ja/docs/setup/production-environment/tools/>日本語 Japanese</a>
<a class=dropdown-item href=/fr/docs/setup/production-environment/tools/>Français</a>
<a class=dropdown-item href=/uk/docs/setup/production-environment/tools/>Українська</a>
</div>
</li>
</ul>
</div>
<button id=hamburger onclick=kub.toggleMenu() data-auto-burger-exclude><div></div></button>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main>
<div class=td-content>
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.
</p><p>
<a href=/id/docs/setup/production-environment/tools/>Return to the regular view of this page</a>.
</p>
</div>
<h1 class=title>Menginstal Kubernetes dengan perkakas penyebaran</h1>
<ul>
<li>1: <a href=#pg-a16f59f325a17cdeed324d5c889f7f73>Menyiapkan klaster dengan kubeadm</a></li>
<ul>
<li>1.1: <a href=#pg-29e59491dd6118b23072dfe9ebb93323>Menginstal kubeadm</a></li>
<li>1.2: <a href=#pg-134ed1f6142a98e6ac681a1ba4920e53>Membuat sebuah klaster dengan control-plane tunggal menggunakan kubeadm</a></li>
<li>1.3: <a href=#pg-3941d5c3409342219bf7e03128b8ecb6>Membangun Klaster dengan Ketersediaan Tinggi menggunakan kubeadm</a></li>
</ul>
</ul>
<div class=content>
</div>
</div>
<div class=td-content>
<h1 id=pg-a16f59f325a17cdeed324d5c889f7f73>1 - Menyiapkan klaster dengan kubeadm</h1>
</div>
<div class=td-content>
<h1 id=pg-29e59491dd6118b23072dfe9ebb93323>1.1 - Menginstal kubeadm</h1>
<p><img src=/images/kubeadm-stacked-color.png align=right width=150px>Laman ini menunjukkan cara untuk menginstal <code>kubeadm</code>.
Untuk informasi mengenai cara membuat sebuah klaster dengan kubeadm setelah kamu melakukan proses instalasi ini, lihat laman <a href=/id/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/>Menggunakan kubeadm untuk Membuat Sebuah Klaster</a>.</p>
<h2 id=sebelum-kamu-memulai>Sebelum kamu memulai</h2>
<ul>
<li>Satu mesin atau lebih yang menjalankan:
<ul>
<li>Ubuntu 16.04+</li>
<li>Debian 9+</li>
<li>CentOS 7</li>
<li>Red Hat Enterprise Linux (RHEL) 7</li>
<li>Fedora 25+</li>
<li>HypriotOS v1.0.1+</li>
<li>Container Linux (teruji pada versi 1800.6.0)</li>
</ul>
</li>
<li>2 GB RAM atau lebih per mesin (kurang dari nilai tersebut akan menyisakan sedikit ruang untuk
aplikasi-aplikasimu)</li>
<li>2 CPU atau lebih</li>
<li>Koneksi internet pada seluruh mesin pada klaster (kamu dapat menggunakan internet
publik ataupun pribadi)</li>
<li><em>Hostname</em> yang unik, alamat MAC, dan product_uuid untuk setiap Node. Lihat <a href=#memastikan-alamat-mac>di sini</a> untuk detail lebih lanjut.</li>
<li>Porta tertentu pada mesin. Lihat <a href=#memeriksa-porta-yang-dibutuhkan>di sini</a> untuk detail lebih lanjut.</li>
<li><em>Swap</em> dinonaktifkan. Kamu <strong>HARUS</strong> menonaktifkan <em>swap</em> agar kubelet dapat berfungsi dengan baik.</li>
</ul>
<h2 id=memastikan-alamat-mac>Memastikan alamat MAC dan product_uuid yang unik untuk setiap Node</h2>
<ul>
<li>Kamu bisa mendapatkan alamat MAC dari antarmuka jaringan menggunakan perintah <code>ip link</code> atau <code>ifconfig -a</code></li>
<li>product_uuid didapatkan dengan perintah <code>sudo cat /sys/class/dmi/id/product_uuid</code></li>
</ul>
<p>Sangat memungkinkan bagi perangkat keras untuk memiliki alamat yang unik, namun beberapa mesin virtual bisa memiliki
nilai yang identik. Kubernetes menggunakan nilai-nilai tersebut untuk mengidentifikasi Node-Node secara unik pada klaster.
Jika nilai-nilai tersebut tidak unik pada tiap Node, proses instalasi
bisa saja <a href=https://github.com/kubernetes/kubeadm/issues/31>gagal</a>.</p>
<h2 id=memeriksa-adaptor-jaringan>Memeriksa adaptor jaringan</h2>
<p>Jika kamu memiliki lebih dari satu adaptor jaringan, dan komponen Kubernetes tidak dapat dijangkau melalui rute bawaan (<em>default route</em>),
kami merekomendasikan kamu untuk menambahkan rute IP sehingga alamat-alamat klaster Kubernetes melewati adaptor yang tepat.</p>
<h2 id=membuat-iptables-melihat-bridged-traffic>Membuat iptables melihat <em>bridged traffic</em></h2>
<p>Agar iptables pada Node Linux dapat melihat <em>bridged traffic</em> dengan benar, kamu harus memastikan <code>net.bridge.bridge-nf-call-iptables</code> bernilai 1 pada pengaturan <code>sysctl</code>, misalnya.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat <span style=color:#b44>&lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf
</span><span style=color:#b44>net.bridge.bridge-nf-call-ip6tables = 1
</span><span style=color:#b44>net.bridge.bridge-nf-call-iptables = 1
</span><span style=color:#b44>EOF</span>
sudo sysctl --system
</code></pre></div><p>Pastikan modul <code>br_netfilter</code> sudah dimuat sebelum melakukan langkah ini. Hal ini dilakukan dengan menjalankan <code>lsmod | grep br_netfilter</code>. Untuk memuatnya secara eksplisit gunakan <code>sudo modprobe br_netfilter</code>.</p>
<p>Untuk detail lebih lanjut, silakan lihat laman <a href=/id/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/#persyaratan-plugin-jaringan>Persyaratan <em>Plugin</em> Jaringan</a>.</p>
<h2 id=memeriksa-porta-yang-dibutuhkan>Memeriksa porta yang dibutuhkan</h2>
<h3 id=node-control-plane>Node <em>control-plane</em></h3>
<table>
<thead>
<tr>
<th>Protokol</th>
<th>Arah</th>
<th>Rentang Porta</th>
<th>Kegunaan</th>
<th>Digunakan oleh</th>
</tr>
</thead>
<tbody>
<tr>
<td>TCP</td>
<td>Inbound</td>
<td>6443*</td>
<td>Kubernetes API server</td>
<td>All</td>
</tr>
<tr>
<td>TCP</td>
<td>Inbound</td>
<td>2379-2380</td>
<td>etcd server client API</td>
<td>kube-apiserver, etcd</td>
</tr>
<tr>
<td>TCP</td>
<td>Inbound</td>
<td>10250</td>
<td>Kubelet API</td>
<td>Self, Control plane</td>
</tr>
<tr>
<td>TCP</td>
<td>Inbound</td>
<td>10251</td>
<td>kube-scheduler</td>
<td>Self</td>
</tr>
<tr>
<td>TCP</td>
<td>Inbound</td>
<td>10252</td>
<td>kube-controller-manager</td>
<td>Self</td>
</tr>
</tbody>
</table>
<h3 id=node-pekerja-worker>Node pekerja (<em>worker</em>)</h3>
<table>
<thead>
<tr>
<th>Protokol</th>
<th>Arah</th>
<th>Rentang Porta</th>
<th>Kegunaan</th>
<th>Digunakan oleh</th>
</tr>
</thead>
<tbody>
<tr>
<td>TCP</td>
<td>Inbound</td>
<td>10250</td>
<td>Kubelet API</td>
<td>Self, Control plane</td>
</tr>
<tr>
<td>TCP</td>
<td>Inbound</td>
<td>30000-32767</td>
<td>NodePort Services†</td>
<td>All</td>
</tr>
</tbody>
</table>
<p>† Jangkauan porta bawaan untuk <a href=/id/docs/concepts/services-networking/service/>Service NodePort</a>.</p>
<p>Angka porta yang ditandai dengan * dapat diganti (<em>overrideable</em>), sehingga kamu harus memastikan porta khusus lainnya yang kamu sediakan juga terbuka.</p>
<p>Meskipun porta etcd turut dituliskan pada Node <em>control-plane</em>, kamu juga bisa menghos klaster etcd-mu sendiri
secara eksternal atau pada porta <em>custom</em>.</p>
<p><em>Plugin</em> jaringan Pod yang kamu gunakan (lihat di bawah) juga mungkin membutuhkan porta tertentu untuk terbuka.
Karena hal ini dapat berbeda pada setiap <em>plugin</em> jaringan Pod, silakan lihat
dokumentasi <em>plugin</em> mengenai porta yang dibutuhkan.</p>
<h2 id=menginstal-runtime>Menginstal <em>runtime</em></h2>
<p>Untuk menjalankan Container pada Pod, Kubernetes menggunakan
<a class=glossary-tooltip title="Runtime Container adalah perangkat lunak yang bertanggung jawab untuk menjalankan Container." data-toggle=tooltip data-placement=top href=/id/docs/setup/production-environment/container-runtimes target=_blank aria-label="_runtime_ Container">_runtime_ Container</a>.</p>
<ul class="nav nav-tabs" id=container-runtime role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#container-runtime-0 role=tab aria-controls=container-runtime-0 aria-selected=true>Linux nodes</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#container-runtime-1 role=tab aria-controls=container-runtime-1>sistem operasi lainnya</a></li></ul>
<div class=tab-content id=container-runtime><div id=container-runtime-0 class="tab-pane show active" role=tabpanel aria-labelledby=container-runtime-0>
<p><p>Secara bawaan, Kubernetes menggunakan
<a class=glossary-tooltip title="Sebuah API untuk mengintegrasikan runtime Container dengan kubelet." data-toggle=tooltip data-placement=top href=/id/docs/concepts/overview/components/#container-runtime target=_blank aria-label="Container Runtime Interface">Container Runtime Interface</a> (CRI)
sebagai perantara dengan <em>runtime</em> Container pilihanmu.</p>
<p>Jika kamu tidak menentukan <em>runtime</em>, kubeadm secara otomatis mencoba untuk mendeteksi
<em>runtime</em> Container yang terinstal dengan memindai sekumpulan soket domain Unix yang umum digunakan.
Tabel berikut menunjukkan <em>runtime</em> Container dan lokasi soketnya:</p>
<table><caption style=display:none>_Runtime_ Container dan lokasi soketnya</caption>
<thead>
<tr>
<th><em>Runtime</em></th>
<th>Lokasi domain soket Unix</th>
</tr>
</thead>
<tbody>
<tr>
<td>Docker</td>
<td><code>/var/run/docker.sock</code></td>
</tr>
<tr>
<td>containerd</td>
<td><code>/run/containerd/containerd.sock</code></td>
</tr>
<tr>
<td>CRI-O</td>
<td><code>/var/run/crio/crio.sock</code></td>
</tr>
</tbody>
</table>
<p><br>
Jika ditemukan Docker dan containerd secara bersamaan, Docker akan terpilih. Hal ini diperlukan
karena Docker 18.09 dirilis dengan containerd dan keduanya dapat ditemukan meskipun kamu
hanya menginstal Docker.
Jika ditemukan selain dari kedua <em>runtime</em> Container tersebut, kubeadm akan berhenti dengan kegagalan.</p>
<p>Komponen kubelet berintegrasi dengan Docker melalui implementasi CRI <code>dockershim</code> bawaannya.</p>
<p>Lihat <a href=/id/docs/setup/production-environment/container-runtimes/><em>runtime</em> Container</a>
untuk informasi lebih lanjut.</p>
</div>
<div id=container-runtime-1 class=tab-pane role=tabpanel aria-labelledby=container-runtime-1>
<p><p>Secara bawaan, kubeadm menggunakan <a class=glossary-tooltip title="Docker merupakan suatu teknologi perangkat lunak yang menyediakan virtualisasi pada level sistem operasi yang juga dikenal sebagai Container." data-toggle=tooltip data-placement=top href=https://docs.docker.com/engine/ target=_blank aria-label=Docker>Docker</a> sebagai <em>runtime</em> Container.
Komponen kubelet berintegrasi dengan Docker melalui implementasi CRI <code>dockershim</code> bawaannya.</p>
<p>Lihat <a href=/id/docs/setup/production-environment/container-runtimes/><em>runtime</em> Container</a>
untuk informasi lebih lanjut.</p>
</div></div>
<h2 id=menginstal-kubeadm-kubelet-dan-kubectl>Menginstal kubeadm, kubelet, dan kubectl</h2>
<p>Kamu akan menginstal <em>package</em> berikut pada semua mesinmu:</p>
<ul>
<li>
<p><code>kubeadm</code>: alat untuk mem-<em>bootstrap</em> klaster.</p>
</li>
<li>
<p><code>kubelet</code>: komponen yang berjalan pada seluruh mesin pada klaster
dan memiliki tugas seperti menjalankan Pod dan Container.</p>
</li>
<li>
<p><code>kubectl</code>: alat untuk berinteraksi dengan klastermu.</p>
</li>
</ul>
<p>Alat kubeadm <strong>tidak akan</strong> menginstal atau mengelola <code>kubelet</code> ataupun <code>kubectl</code> untukmu, jadi kamu harus memastikan
keduanya memiliki versi yang cocok dengan <em>control plane</em> Kubernetes yang akan kamu instal
dengan kubeadm. Jika tidak, ada risiko <em>version skew</em> yang dapat terjadi dan
dapat berujung pada perangai yang bermasalah dan tidak terduga. Namun, <em>satu</em> <em>version skew</em> minor antara
kubelet dan <em>control plane</em> masih diperbolehkan, tetapi versi kubelet tidak boleh melebihi versi API
Server. Sebagai contoh, kubelet yang berjalan pada versi 1.7.0 akan kompatibel dengan API Server versi 1.8.0, tetapi tidak sebaliknya.</p>
<p>Untuk informasi mengenai instalasi <code>kubectl</code>, lihat <a href=/id/docs/tasks/tools/install-kubectl/>Menginstal dan mengatur kubectl</a>.</p>
<div class="alert alert-danger warning callout" role=alert>
<strong>Peringatan:</strong> Instruksi ini membuat seluruh <em>package</em> Kubernetes keluar dari <em>system upgrade</em>.
Hal ini karena kubeadm dan Kubernetes membutuhkan
<a href=/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/>perhatian khusus untuk pembaharuan</a>.
</div>
<p>Untuk informasi lebih lanjut mengenai <em>version skew</em>, lihat:</p>
<ul>
<li><a href=/docs/setup/release/version-skew-policy/>Kebijakan <em>version-skew</em> dan versi Kubernetes</a></li>
<li><a href=/id/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#version-skew-policy>Kebijakan <em>version skew</em></a> yang spesifik untuk kubeadm</li>
</ul>
<ul class="nav nav-tabs" id=k8s-install role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#k8s-install-0 role=tab aria-controls=k8s-install-0 aria-selected=true>Ubuntu, Debian atau HypriotOS</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#k8s-install-1 role=tab aria-controls=k8s-install-1>CentOS, RHEL atau Fedora</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#k8s-install-2 role=tab aria-controls=k8s-install-2>Container Linux</a></li></ul>
<div class=tab-content id=k8s-install><div id=k8s-install-0 class="tab-pane show active" role=tabpanel aria-labelledby=k8s-install-0>
<p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo apt-get update <span style=color:#666>&amp;&amp;</span> sudo apt-get install -y apt-transport-https curl
curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key add -
cat <span style=color:#b44>&lt;&lt;EOF | sudo tee /etc/apt/sources.list.d/kubernetes.list
</span><span style=color:#b44>deb https://apt.kubernetes.io/ kubernetes-xenial main
</span><span style=color:#b44>EOF</span>
sudo apt-get update
sudo apt-get install -y kubelet kubeadm kubectl
sudo apt-mark hold kubelet kubeadm kubectl
</code></pre></div></div>
<div id=k8s-install-1 class=tab-pane role=tabpanel aria-labelledby=k8s-install-1>
<p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat <span style=color:#b44>&lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo
</span><span style=color:#b44>[kubernetes]
</span><span style=color:#b44>name=Kubernetes
</span><span style=color:#b44>baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-\$basearch
</span><span style=color:#b44>enabled=1
</span><span style=color:#b44>gpgcheck=1
</span><span style=color:#b44>repo_gpgcheck=1
</span><span style=color:#b44>gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
</span><span style=color:#b44>exclude=kubelet kubeadm kubectl
</span><span style=color:#b44>EOF</span>

<span style=color:#080;font-style:italic># Mengatur SELinux menjadi permissive mode (menonaktifkannya secara efektif)</span>
setenforce <span style=color:#666>0</span>
sed -i <span style=color:#b44>&#39;s/^SELINUX=enforcing$/SELINUX=permissive/&#39;</span> /etc/selinux/config

yum install -y kubelet kubeadm kubectl --disableexcludes<span style=color:#666>=</span>kubernetes

systemctl <span style=color:#a2f>enable</span> --now kubelet
</code></pre></div><p><strong>Catatan:</strong></p>
<ul>
<li>
<p>Mengatur SELinux menjadi <em>permissive mode</em> dengan menjalankan <code>setenforce 0</code> dan <code>sed ...</code> menonaktifkannya secara efektif.
Hal ini diperlukan untuk mengizinkan Container untuk mengakses <em>filesystem</em> hos, yang dibutuhkan untuk jaringan Pod sebagai contoh.
Kamu harus melakukan ini sampai dukungan SELinux ditingkatkan pada kubelet.</p>
</li>
<li>
<p>Kamu dapat membiarkan SELinux aktif jika kamu mengetahui cara mengonfigurasinya, tetapi hal tersebut mungkin membutuhkan pengaturan yang tidak didukung oleh kubeadm.</p>
</li>
</ul>
</div>
<div id=k8s-install-2 class=tab-pane role=tabpanel aria-labelledby=k8s-install-2>
<p><p>Menginstal <em>plugin</em> CNI (dibutuhkan untuk kebanyakan jaringan Pod):</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#b8860b>CNI_VERSION</span><span style=color:#666>=</span><span style=color:#b44>&#34;v0.8.2&#34;</span>
<span style=color:#b8860b>ARCH</span><span style=color:#666>=</span><span style=color:#b44>&#34;amd64&#34;</span>
mkdir -p /opt/cni/bin
curl -L <span style=color:#b44>&#34;https://github.com/containernetworking/plugins/releases/download/</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>CNI_VERSION</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>/cni-plugins-linux-</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>ARCH</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>-</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>CNI_VERSION</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>.tgz&#34;</span> | tar -C /opt/cni/bin -xz
</code></pre></div><p>Menginstal crictl (dibutuhkan untuk kubeadm / Kubelet Container Runtime Interface (CRI))</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#b8860b>CRICTL_VERSION</span><span style=color:#666>=</span><span style=color:#b44>&#34;v1.22.0&#34;</span>
<span style=color:#b8860b>ARCH</span><span style=color:#666>=</span><span style=color:#b44>&#34;amd64&#34;</span>
mkdir -p /opt/bin
curl -L <span style=color:#b44>&#34;https://github.com/kubernetes-sigs/cri-tools/releases/download/</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>CRICTL_VERSION</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>/crictl-</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>CRICTL_VERSION</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>-linux-</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>ARCH</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>.tar.gz&#34;</span> | sudo tar -C <span style=color:#b8860b>$DOWNLOAD_DIR</span> -xz
</code></pre></div><p>Menginstal <code>kubeadm</code>, <code>kubelet</code>, <code>kubectl</code> dan menambahkan <em>systemd service</em> <code>kubelet</code>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#b8860b>RELEASE</span><span style=color:#666>=</span><span style=color:#b44>&#34;</span><span style=color:#a2f;font-weight:700>$(</span>curl -sSL https://dl.k8s.io/release/stable.txt<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>&#34;</span>

mkdir -p /opt/bin
<span style=color:#b8860b>ARCH</span><span style=color:#666>=</span><span style=color:#b44>&#34;amd64&#34;</span>
<span style=color:#a2f>cd</span> /opt/bin
curl -L --remote-name-all https://storage.googleapis.com/kubernetes-release/release/<span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>RELEASE</span><span style=color:#b68;font-weight:700>}</span>/bin/linux/<span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>ARCH</span><span style=color:#b68;font-weight:700>}</span>/<span style=color:#666>{</span>kubeadm,kubelet,kubectl<span style=color:#666>}</span>
chmod +x <span style=color:#666>{</span>kubeadm,kubelet,kubectl<span style=color:#666>}</span>

<span style=color:#b8860b>RELEASE_VERSION</span><span style=color:#666>=</span><span style=color:#b44>&#34;v0.2.7&#34;</span>
curl -sSL <span style=color:#b44>&#34;https://raw.githubusercontent.com/kubernetes/release/</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>RELEASE_VERSION</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>/cmd/kubepkg/templates/latest/deb/kubelet/lib/systemd/system/kubelet.service&#34;</span> | sed <span style=color:#b44>&#34;s:/usr/bin:/opt/bin:g&#34;</span> &gt; /etc/systemd/system/kubelet.service
mkdir -p /etc/systemd/system/kubelet.service.d
curl -sSL <span style=color:#b44>&#34;https://raw.githubusercontent.com/kubernetes/release/</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>RELEASE_VERSION</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>/cmd/kubepkg/templates/latest/deb/kubeadm/10-kubeadm.conf&#34;</span> | sed <span style=color:#b44>&#34;s:/usr/bin:/opt/bin:g&#34;</span> &gt; /etc/systemd/system/kubelet.service.d/10-kubeadm.conf
</code></pre></div><p>Mengaktifkan dan menjalankan <code>kubelet</code>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>systemctl <span style=color:#a2f>enable</span> --now kubelet
</code></pre></div></div></div>
<p>Sekarang kubelet akan melakukan <em>restart</em> setiap beberapa detik, sambil menunggu dalam kondisi <em>crashloop</em> sampai kubeadm memberikan instruksi yang harus dilakukan.</p>
<h2 id=mengonfigurasi-cgroup-untuk-kubelet-pada-node-control-plane>Mengonfigurasi <em>driver</em> cgroup yang digunakan oleh kubelet pada Node <em>control-plane</em></h2>
<p>Ketika menggunakan Docker, kubeadm akan mendeteksi secara otomatis <em>driver</em> cgroup untuk kubelet
dan mengaturnya pada berkas <code>/var/lib/kubelet/config.yaml</code> pada saat <em>runtime</em>.</p>
<p>Jika kamu menggunakan CRI yang berbeda, kamu harus memodifikasi berkasnya dengan nilai <code>cgroupDriver</code> yang kamu gunakan, seperti berikut:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>kubelet.config.k8s.io/v1beta1<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>KubeletConfiguration<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:green;font-weight:700>cgroupDriver</span>:<span style=color:#bbb> </span>&lt;value&gt;<span style=color:#bbb>
</span></code></pre></div><p>Harap diperhatikan, kamu <strong>hanya</strong> perlu melakukannya jika <em>driver</em> cgroup dari CRI pilihanmu
bukanlah <code>cgroupfs</code>, karena nilai tersebut merupakan nilai bawaan yang digunakan oleh kubelet.</p>
<div class="alert alert-info note callout" role=alert>
<strong>Catatan:</strong> Karena opsi <code>--cgroup-driver</code> sudah dihilangkan pada kubelet, jika kamu memilikinya pada <code>/var/lib/kubelet/kubeadm-flags.env</code>
atau <code>/etc/default/kubelet</code>(<code>/etc/sysconfig/kubelet</code> untuk RPM), silakan hapus dan gunakan KubeletConfiguration
(secara bawaan disimpan di <code>/var/lib/kubelet/config.yaml</code>).
</div>
<p>Kamu harus melakukan <em>restart</em> pada kubelet:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>sudo systemctl daemon-reload
sudo systemctl restart kubelet
</code></pre></div><p>Deteksi <em>driver</em> cgroup secara otomatis untuk <em>runtime</em> Container lainnya
seperti CRI-O dan containerd masih dalam proses pengembangan.</p>
<h2 id=penyelesaian-masalah>Penyelesaian masalah</h2>
<p>Jika kamu menemui kesulitan dengan kubeadm, silakan merujuk pada <a href=/docs/setup/production-environment/tools/kubeadm/troubleshooting-kubeadm/>dokumen penyelesaian masalah</a>.</p>
<h2 id=selanjutnya>Selanjutnya</h2>
<ul>
<li><a href=/id/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/>Menggunakan kubeadm untuk Membuat Sebuah Klaster</a></li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-134ed1f6142a98e6ac681a1ba4920e53>1.2 - Membuat sebuah klaster dengan control-plane tunggal menggunakan kubeadm</h1>
<p>Perkakas <img src=/images/kubeadm-stacked-color.png align=right width=150px><code>kubeadm</code> membantu kamu membuat sebuah klaster Kubernetes minimum yang layak dan sesuai dengan <em>best practice</em>. Bahkan, kamu dapat menggunakan <code>kubeadm</code> untuk membuat sebuah klaster yang lolos <a href=https://kubernetes.io/blog/2017/10/software-conformance-certification>uji Kubernetes Conformance</a>.<br>
<code>kubeadm</code> juga mendukung fungsi siklus hidup (<em>lifecycle</em>)
klaster lainnya, seperti <a href=/docs/reference/access-authn-authz/bootstrap-tokens/><em>bootstrap token</em></a> dan pembaruan klaster (<em>cluster upgrade</em>).</p>
<p><code>kubeadm</code> merupakan perkakas yang bagus jika kamu membutuhkan:</p>
<ul>
<li>Sebuah cara yang sederhana untuk kamu mencoba Kubernetes, mungkin untuk pertama kalinya.</li>
<li>Sebuah cara bagi pengguna lama (<em>existing users</em>) untuk mengotomatiskan penyetelan sebuah klaster dan menguji aplikasi mereka.</li>
<li>Sebuah komponen dasar pada ekosistem lain dan/atau perkakas penginstal lain dengan cakupan
yang lebih luas.</li>
</ul>
<p>Kamu dapat menginstal dan menggunakan <code>kubeadm</code> pada berbagai macam mesin: laptop milikmu, sekelompok
server di <em>cloud</em>, sebuah Raspberry Pi, dan lain-lain. Baik itu men-<em>deploy</em> pada
<em>cloud</em> ataupun <em>on-premise</em>, kamu dapat mengintegrasikan <code>kubeadm</code> pada sistem <em>provisioning</em> seperti
Ansible atau Terraform.</p>
<h2 id=sebelum-kamu-memulai>Sebelum kamu memulai</h2>
<p>Untuk mengikuti panduan ini, kamu membutuhkan:</p>
<ul>
<li>Satu mesin atau lebih, yang menjalankan sistem operasi Linux yang kompatibel dengan deb atau rpm; sebagai contoh: Ubuntu atau CentOS.</li>
<li>2 GiB atau lebih RAM per mesin--kurang dari nilai tersebut akan menyisakan sedikit ruang untuk
aplikasi-aplikasimu.</li>
<li>Sedikitnya 2 CPU pada mesin yang akan kamu gunakan sebagai Node <em>control-plane</em>.</li>
<li>Koneksi internet pada seluruh mesin pada klaster. Kamu dapat menggunakan internet
publik ataupun pribadi.</li>
</ul>
<p>Kamu juga harus menggunakan versi <code>kubeadm</code> yang dapat men-<em>deploy</em> versi
Kubernetes yang ingin kamu gunakan pada klaster barumu.</p>
<p><a href=https://kubernetes.io/docs/setup/release/version-skew-policy/#supported-versions>Kebijakan dukungan versi Kubernetes dan <em>version skew</em></a> juga berlaku pada <code>kubeadm</code> dan Kubernetes secara umum.
Periksa kebijakan tersebut untuk mempelajari tentang versi Kubernetes dan <code>kubeadm</code>
mana saja yang didukung. Laman ini ditulis untuk Kubernetes v1.23.</p>
<p>Fitur <code>kubeadm</code> secara umum berstatus <em>General Availability</em> (GA). Beberapa sub-fitur sedang
berada dalam pengembangan. Implementasi pembuatan klaster dapat berubah
sedikit seiring dengan berevolusinya kubeadm, namun secara umum implementasinya sudah cukup stabil.</p>
<div class="alert alert-info note callout" role=alert>
<strong>Catatan:</strong> Semua perintah di dalam <code>kubeadm alpha</code>, sesuai definisi, didukung pada level <em>alpha</em>.
</div>
<h2 id=tujuan>Tujuan</h2>
<ul>
<li>Menginstal Kubernetes klaster dengan <em>control-plane</em> tunggal atau <a href=/docs/setup/production-environment/tools/kubeadm/high-availability/>klaster dengan ketersediaan tinggi</a></li>
<li>Menginstal jaringan Pod pada klaster sehingga Pod dapat
berinteraksi satu sama lain</li>
</ul>
<h2 id=instruksi>Instruksi</h2>
<h3 id=menginstal-kubeadm-pada-hos>Menginstal kubeadm pada hos</h3>
<p>Lihat <a href=/id/docs/setup/production-environment/tools/kubeadm/install-kubeadm/>"Menginstal kubeadm"</a>.</p>
<div class="alert alert-info note callout" role=alert>
<strong>Catatan:</strong> <p>Jika kamu sudah menginstal kubeadm sebelumnya, jalankan <code>apt-get update && apt-get upgrade</code> atau <code>yum update</code> untuk mendapatkan versi kubeadm paling baru.</p>
<p>Ketika kamu melakukan pembaruan, kubelet melakukan <em>restart</em> setiap beberapa detik sambil menunggu dalam kondisi <em>crashloop</em> sampai
kubeadm memberikan perintah yang harus dilakukan. <em>Crashloop</em> ini memang diantisipasi dan normal.
Setelah kamu menginisialisasi <em>control-plane</em>, kubelet akan berjalan normal.</p>
</div>
<h3 id=menginisialisasi-node-control-plane>Menginisialisasi Node <em>control-plane</em></h3>
<p>Node <em>control-plane</em> adalah mesin dimana komponen-komponen <em>control plane</em> berjalan, termasuk
<a class=glossary-tooltip title="Penyimpanan key value konsisten yang digunakan sebagai penyimpanan data klaster Kubernetes." data-toggle=tooltip data-placement=top href=/docs/tasks/administer-cluster/configure-upgrade-etcd/ target=_blank aria-label=etcd>etcd</a> (basis data klaster) dan
<a class=glossary-tooltip title="Komponen control plane yang mengekspos API Kubernetes. Merupakan front-end dari control plane Kubernetes." data-toggle=tooltip data-placement=top href=/docs/reference/generated/kube-apiserver/ target=_blank aria-label="API Server">API Server</a>
(yang akan berkomunikasi dengan perkakas <em>command line</em> <a class=glossary-tooltip title="Sebuah utilitas baris perintah untuk berkomunikasi dengan suatu server API Kubernetes." data-toggle=tooltip data-placement=top href=/docs/user-guide/kubectl-overview/ target=_blank aria-label=kubectl>kubectl</a>.</p>
<ol>
<li>(Direkomendasikan) Jika kamu berencana untuk memperbarui klaster <code>kubeadm</code> dengan <em>control-plane</em> tunggal
menjadi ketersediaan tinggi kamu harus menentukan <code>--control-plane-endpoint</code> agar mengarah ke <em>endpoint</em> yang digunakan bersama
untuk semua Node <em>control-plane</em>. <em>Endpoint</em> tersebut dapat berupa nama DNS atau sebuah alamat IP dari <em>load-balancer</em>.</li>
<li>Pilih <em>add-on</em> jaringan Pod, dan pastikan apakah diperlukan argumen untuk
diberikan pada <code>kubeadm init</code>. Tergantung
penyedia pihak ketiga yang kamu pilih, kamu mungkin harus mengatur <code>--pod-network-cidr</code> dengan nilai
yang spesifik pada penyedia tertentu. Lihat <a href=#jaringan-pod>Menginstal <em>add-on</em> jaringan Pod</a>.</li>
<li>(Opsional) Sejak versi 1.14, <code>kubeadm</code> mencoba untuk mendeteksi <em>runtime</em> kontainer pada Linux
dengan menggunakan daftar <em>domain socket path</em> yang umum diketahui. Untuk menggunakan <em>runtime</em> kontainer yang berbeda atau
jika ada lebih dari satu yang terpasang pada Node yang digunakan, tentukan argumen <code>--cri-socket</code>
pada <code>kubeadm init</code>. Lihat <a href=/id/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#installing-runtime>Menginstal <em>runtime</em></a>.</li>
<li>(Opsional) Kecuali ditentukan sebelumnya, <code>kubeadm</code> akan menggunakan antarmuka jaringan yang diasosiasikan
dengan <em>default gateway</em> untuk mengatur alamat <em>advertise</em> untuk API Server pada Node <em>control-plane</em> ini.
Untuk menggunakan antarmuka jaringan yang berbeda, tentukan argumen <code>--apiserver-advertise-address=&lt;ip-address></code>
pada <code>kubeadm init</code>. Untuk men-<em>deploy</em> klaster Kubernetes IPv6 menggunakan pengalamatan IPv6, kamu
harus menentukan alamat IPv6, sebagai contoh <code>--apiserver-advertise-address=fd00::101</code></li>
<li>(Opsional) Jalankan <code>kubeadm config images pull</code> sebelum <code>kubeadm init</code> untuk memastikan
konektivitas ke <em>container image registry</em> gcr.io.</li>
</ol>
<p>Untuk menginisialisasi Node <em>control-plane</em> jalankan:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubeadm init &lt;args&gt;
</code></pre></div><h3 id=pertimbangan-mengenai-apiserver-advertise-address-dan-controlplaneendpoint>Pertimbangan mengenai apiserver-advertise-address dan ControlPlaneEndpoint</h3>
<p>Meski <code>--apiserver-advertise-address</code> dapat digunakan untuk mengatur alamat <em>advertise</em> untuk server
API pada Node <em>control-plane</em> ini, <code>--control-plane-endpoint</code> dapat digunakan untuk mengatur <em>endpoint</em> yang digunakan bersama
untuk seluruh Node <em>control-plane</em>.</p>
<p><code>--control-plane-endpoint</code> tidak hanya mengizinkan alamat IP tetapi juga nama DNS yang dapat dipetakan ke alamat IP.
Silakan hubungi administrator jaringan kamu untuk mengevaluasi solusi-solusi yang mempertimbangkan pemetaan tersebut.</p>
<p>Berikut contoh pemetaannya:</p>
<pre><code>192.168.0.102 cluster-endpoint
</code></pre><p>Di mana <code>192.168.0.102</code> merupakan alamat IP dari Node ini dan <code>cluster-endpoint</code> merupakan nama DNS <em>custom</em> yang dipetakan pada IP ini.
Hal ini memungkinkan kamu untuk memberikan <code>--control-plane-endpoint=cluster-endpoint</code> pada <code>kubeadm init</code> dan memberikan nama DNS yang sama pada
<code>kubeadm join</code>. Kemudian kamu dapat memodifikasi <code>cluster-endpoint</code> untuk mengarah pada alamat <em>load-balancer</em> dalam skenario
ketersediaan tinggi (<em>highly availabile</em>).</p>
<p>Mengubah klaster <em>control plane</em> tunggal yang dibuat tanpa <code>--control-plane-endpoint</code> menjadi klaster dengan ketersediaan tinggi
tidak didukung oleh kubeadm.</p>
<h3 id=informasi-lebih-lanjut>Informasi lebih lanjut</h3>
<p>Untuk informasi lebih lanjut mengenai argumen-argumen <code>kubeadm init</code>, lihat <a href=/docs/reference/setup-tools/kubeadm/>panduan referensi kubeadm</a>.</p>
<p>Untuk daftar pengaturan konfigurasi yang lengkap, lihat <a href=/docs/reference/setup-tools/kubeadm/kubeadm-init/#config-file>dokumentasi berkas konfigurasi</a>.</p>
<p>Untuk menyetel komponen-komponen <em>control plane</em>, termasuk pemasangan IPv6 opsional pada <em>liveness probe</em> untuk komponen-komponen <em>control plane</em> dan server etcd, berikan argumen ekstra pada tiap komponen seperti yang didokumentasikan pada <a href=/docs/setup/production-environment/tools/kubeadm/control-plane-flags/>argumen-argumen <em>custom</em></a>.</p>
<p>Untuk menjalankan <code>kubeadm init</code> lagi, sebelumnya kamu harus <a href=#pembongkaran>membongkar klaster</a>.</p>
<p>Jika kamu menggabungkan sebuah Node dengan arsitektur yang berbeda ke klastermu, pastikan DaemonSets yang di_deploy_
memiliki _image_ kontainer yang mendukung arsitektur tersebut.</p>
<p>Pertama-tama <code>kubeadm init</code> akan menjalankan sekumpulan <em>precheck</em> untuk memastikan mesin
siap untuk menjalankan Kubernetes. Kumpulan <em>precheck</em> ini menunjukkan peringatan-peringatan dan akan berhenti jika terjadi kesalahan. Kemudian <code>kubeadm init</code>
akan mengunduh dan menginstal komponen-komponen <em>control plane</em> klaster. Hal ini membutuhkan waktu beberapa menit.
Keluaran yang dihasilkan terlihat seperti berikut ini:</p>
<pre><code class=language-none data-lang=none>[init] Using Kubernetes version: vX.Y.Z
[preflight] Running pre-flight checks
[preflight] Pulling images required for setting up a Kubernetes cluster
[preflight] This might take a minute or two, depending on the speed of your internet connection
[preflight] You can also perform this action in beforehand using 'kubeadm config images pull'
[kubelet-start] Writing kubelet environment file with flags to file &quot;/var/lib/kubelet/kubeadm-flags.env&quot;
[kubelet-start] Writing kubelet configuration to file &quot;/var/lib/kubelet/config.yaml&quot;
[kubelet-start] Activating the kubelet service
[certs] Using certificateDir folder &quot;/etc/kubernetes/pki&quot;
[certs] Generating &quot;etcd/ca&quot; certificate and key
[certs] Generating &quot;etcd/server&quot; certificate and key
[certs] etcd/server serving cert is signed for DNS names [kubeadm-cp localhost] and IPs [10.138.0.4 127.0.0.1 ::1]
[certs] Generating &quot;etcd/healthcheck-client&quot; certificate and key
[certs] Generating &quot;etcd/peer&quot; certificate and key
[certs] etcd/peer serving cert is signed for DNS names [kubeadm-cp localhost] and IPs [10.138.0.4 127.0.0.1 ::1]
[certs] Generating &quot;apiserver-etcd-client&quot; certificate and key
[certs] Generating &quot;ca&quot; certificate and key
[certs] Generating &quot;apiserver&quot; certificate and key
[certs] apiserver serving cert is signed for DNS names [kubeadm-cp kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local] and IPs [10.96.0.1 10.138.0.4]
[certs] Generating &quot;apiserver-kubelet-client&quot; certificate and key
[certs] Generating &quot;front-proxy-ca&quot; certificate and key
[certs] Generating &quot;front-proxy-client&quot; certificate and key
[certs] Generating &quot;sa&quot; key and public key
[kubeconfig] Using kubeconfig folder &quot;/etc/kubernetes&quot;
[kubeconfig] Writing &quot;admin.conf&quot; kubeconfig file
[kubeconfig] Writing &quot;kubelet.conf&quot; kubeconfig file
[kubeconfig] Writing &quot;controller-manager.conf&quot; kubeconfig file
[kubeconfig] Writing &quot;scheduler.conf&quot; kubeconfig file
[control-plane] Using manifest folder &quot;/etc/kubernetes/manifests&quot;
[control-plane] Creating static Pod manifest for &quot;kube-apiserver&quot;
[control-plane] Creating static Pod manifest for &quot;kube-controller-manager&quot;
[control-plane] Creating static Pod manifest for &quot;kube-scheduler&quot;
[etcd] Creating static Pod manifest for local etcd in &quot;/etc/kubernetes/manifests&quot;
[wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory &quot;/etc/kubernetes/manifests&quot;. This can take up to 4m0s
[apiclient] All control plane components are healthy after 31.501735 seconds
[uploadconfig] storing the configuration used in ConfigMap &quot;kubeadm-config&quot; in the &quot;kube-system&quot; Namespace
[kubelet] Creating a ConfigMap &quot;kubelet-config-X.Y&quot; in namespace kube-system with the configuration for the kubelets in the cluster
[patchnode] Uploading the CRI Socket information &quot;/var/run/dockershim.sock&quot; to the Node API object &quot;kubeadm-cp&quot; as an annotation
[mark-control-plane] Marking the node kubeadm-cp as control-plane by adding the label &quot;node-role.kubernetes.io/master=''&quot;
[mark-control-plane] Marking the node kubeadm-cp as control-plane by adding the taints [node-role.kubernetes.io/master:NoSchedule]
[bootstrap-token] Using token: &lt;token&gt;
[bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles
[bootstraptoken] configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials
[bootstraptoken] configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token
[bootstraptoken] configured RBAC rules to allow certificate rotation for all node client certificates in the cluster
[bootstraptoken] creating the &quot;cluster-info&quot; ConfigMap in the &quot;kube-public&quot; namespace
[addons] Applied essential addon: CoreDNS
[addons] Applied essential addon: kube-proxy

Your Kubernetes control-plane has initialized successfully!

To start using your cluster, you need to run the following as a regular user:

  mkdir -p $HOME/.kube
  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
  sudo chown $(id -u):$(id -g) $HOME/.kube/config

You should now deploy a Pod network to the cluster.
Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at:
  /docs/concepts/cluster-administration/addons/

You can now join any number of machines by running the following on each node
as root:

  kubeadm join &lt;control-plane-host&gt;:&lt;control-plane-port&gt; --token &lt;token&gt; --discovery-token-ca-cert-hash sha256:&lt;hash&gt;
</code></pre><p>Untuk membuat kubectl bekerja bagi pengguna <em>non-root</em>, jalankan perintah-perintah berikut, yang juga merupakan
bagian dari keluaran <code>kubeadm init</code>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mkdir -p <span style=color:#b8860b>$HOME</span>/.kube
sudo cp -i /etc/kubernetes/admin.conf <span style=color:#b8860b>$HOME</span>/.kube/config
sudo chown <span style=color:#a2f;font-weight:700>$(</span>id -u<span style=color:#a2f;font-weight:700>)</span>:<span style=color:#a2f;font-weight:700>$(</span>id -g<span style=color:#a2f;font-weight:700>)</span> <span style=color:#b8860b>$HOME</span>/.kube/config
</code></pre></div><p>Secara alternatif, jika kamu adalah pengguna <code>root</code>, kamu dapat menjalankan:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#a2f>export</span> <span style=color:#b8860b>KUBECONFIG</span><span style=color:#666>=</span>/etc/kubernetes/admin.conf
</code></pre></div><p>Buatlah catatan dari perintah <code>kubeadm join</code> yang dihasilkan <code>kubeadm init</code>. Kamu
membutuhkan perintah ini untuk <a href=#menggabungkan-node>menggabungkan Node-Node ke klaster</a>.</p>
<p><em>Token</em> digunakan untuk otentikasi bersama (<em>mutual authentication</em>) antara Node <em>control-plane</em> dan Node-Node yang
akan bergabung. <em>Token</em> yang didapat di sini bersifat rahasia. Simpan dengan aman, karena siapapun yang memiliki token tersebut
dapat menambahkan Node-Node yang dapat mengotentikasikan diri ke klaster. Kamu dapat menampilkan daftar <em>token</em>,
membuat, dan menghapus <em>token</em> dengan perintah <code>kubeadm token</code>. Lihat
<a href=/docs/reference/setup-tools/kubeadm/kubeadm-token/>panduan referensi kubeadm</a>.</p>
<h3 id=jaringan-pod>Menginstal <em>add-on</em> jaringan Pod</h3>
<div class="alert alert-warning caution callout" role=alert>
<strong>Perhatian:</strong> <p>Bagian ini berisi informasi penting mengenai penyetelan jejaring dan
urutan <em>deployment</em>.
Baca seluruh saran ini dengan saksama sebelum melanjutkan.</p>
<p><strong>Kamu harus men-<em>deploy</em>
<em>add-on</em> jaringan Pod berbasis <a class=glossary-tooltip title="Container network interface (CNI) plugins are a type of Network plugin that adheres to the appc/CNI specification." data-toggle=tooltip data-placement=top href=/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/#cni target=_blank aria-label="_Container Network Interface_"><em>Container Network Interface</em></a>
(CNI) sehingga Pod dapat berkomunikasi satu sama lain.<br>
DNS klaster (CoreDNS) tidak akan menyala sebelum jaringan dipasangkan.</strong></p>
<ul>
<li>
<p>Perlu diperhatikan bahwa jaringan Pod tidak boleh tumpang tindih dengan jaringan hos
manapun: kamu akan menemui beberapa masalah jika terjadi tumpang tindih.<br>
(Jika kamu menemukan adanya bentrokan antara jaringan Pod
pilihan <em>plugin</em> jaringan dengan jaringan hos, kamu harus memikirkan blok
CIDR yang cocok untuk digunakan, kemudian menggunakannya pada saat <code>kubeadm init</code> dengan
<code>--pod-network-cidr</code>, atau sebagai penggantinya pada YAML <em>plugin</em> jaringan kamu).</p>
</li>
<li>
<p>Secara bawaan, <code>kubeadm</code> mengatur klastermu untuk menggunakan dan melaksanakan penggunaan
<a href=/id/docs/reference/access-authn-authz/rbac/>RBAC</a> (<em>role based access control</em>).<br>
Pastikan <em>plugin</em> jaringan Pod mendukung RBAC, dan begitu juga seluruh manifes
yang kamu gunakan untuk men-<em>deploy</em>-nya.</p>
</li>
<li>
<p>Jika kamu ingin menggunakan IPv6--baik jaringan <em>dual-stack</em>, ataupun jaringan <em>single-stack</em> IPv6
--untuk klastermu, pastikan <em>plugin</em> jaringan Pod
mendukung IPv6.<br>
Dukungan IPv6 telah ditambahkan pada CNI sejak <a href=https://github.com/containernetworking/cni/releases/tag/v0.6.0>v0.6.0</a>.</p>
</li>
</ul>
</div>
<div class="alert alert-info note callout" role=alert>
<strong>Catatan:</strong> Saat ini Calico adalah satu-satunya <em>plugin</em> CNI yang dapat menerima uji e2e (<em>end-to-end</em>) oleh proyek kubeadm.
Jika kamu menemukan isu terkait <em>plugin</em> CNI kamu harus membuat tiket pada pelacak isu masing-masing <em>plugin</em>,
bukan pada pelacak isu kubeadm maupun kubernetes.
</div>
<p>Beberapa proyek eksternal menyediakan jaringan Pod Kubernetes menggunakan CNI, beberapa di antaranya juga
mendukung <a href=/docs/concepts/services-networking/networkpolicies/>Network Policy</a>.</p>
<p>Lihat daftar
<a href=https://kubernetes.io/docs/concepts/cluster-administration/addons/#networking-and-network-policy><em>add-on</em> jejaring dan <em>network policy</em></a> yang tersedia.</p>
<p>Kamu dapat menginstal <em>add-on</em> jaringan Pod dengan perintah berikut pada Node
<em>control-plane</em> atau Node yang memiliki kredensial kubeconfig:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl apply -f &lt;add-on.yaml&gt;
</code></pre></div><p>Kamu hanya dapat menginstal satu jaringan Pod per klaster.
Di bawah ini kamu dapat menemukan instruksi instalasi untuk beberapa <em>plugin</em> jaringan Pod yang populer:</p>
<ul class="nav nav-tabs" id=tabs-pod-install role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#tabs-pod-install-0 role=tab aria-controls=tabs-pod-install-0 aria-selected=true>Calico</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabs-pod-install-1 role=tab aria-controls=tabs-pod-install-1>Cilium</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabs-pod-install-2 role=tab aria-controls=tabs-pod-install-2>Contiv-VPP</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabs-pod-install-3 role=tab aria-controls=tabs-pod-install-3>Kube-router</a></li>
<li class=nav-item><a data-toggle=tab class=nav-link href=#tabs-pod-install-4 role=tab aria-controls=tabs-pod-install-4>Weave Net</a></li></ul>
<div class=tab-content id=tabs-pod-install><div id=tabs-pod-install-0 class="tab-pane show active" role=tabpanel aria-labelledby=tabs-pod-install-0>
<p><p><a href=https://docs.projectcalico.org/latest/introduction/>Calico</a> merupakan penyedia jejaring dan <em>network policy</em>. Calico mendukung sekumpulan opsi jejaring yang fleksibel sehingga kamu dapat memilih opsi yang paling efisien untuk situasimu, termasuk jaringan <em>non-overlay</em> dan <em>overlay</em>, dengan atau tanpa BGP. Calico menggunakan mesin yang sama untuk melaksanakan <em>network policy</em> pada hos, Pod, dan (jika menggunakan Istio & Envoy) aplikasi yang berada pada lapisan <em>service mesh</em>. Calico bekerja pada beberapa arsitektur, meliputi <code>amd64</code>, <code>arm64</code>, dan <code>ppc64le</code>.</p>
<p>Secara bawaan, Calico menggunakan <code>192.168.0.0/16</code> sebagai CIDR jaringan Pod, namun hal ini dapat diatur pada berkas calico.yaml. Agar Calico dapat bekerja dengan benar, kamu perlu memberikan CIDR yang sama pada perintah <code>kubeadm init</code> menggunakan opsi <code>--pod-network-cidr=192.168.0.0/16</code> atau melalui konfigurasi kubeadm.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl apply -f https://docs.projectcalico.org/v3.11/manifests/calico.yaml
</code></pre></div></div>
<div id=tabs-pod-install-1 class=tab-pane role=tabpanel aria-labelledby=tabs-pod-install-1>
<p><p>Agar Cilium dapat bekerja dengan benar, kamu harus memberikan <code>--pod-network-cidr=10.217.0.0/16</code> pada <code>kubeadm init</code>.</p>
<p>Untuk men-<em>deploy</em> Cilium kamu hanya perlu menjalankan:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl create -f https://raw.githubusercontent.com/cilium/cilium/v1.6/install/kubernetes/quick-install.yaml
</code></pre></div><p>Ketika seluruh Pod Cilium sudah bertanda <code>READY</code>, kamu dapat mulai menggunakan klaster.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get pods -n kube-system --selector<span style=color:#666>=</span>k8s-app<span style=color:#666>=</span>cilium
</code></pre></div><p>Keluarannya akan tampil seperti berikut:</p>
<pre><code>NAME           READY   STATUS    RESTARTS   AGE
cilium-drxkl   1/1     Running   0          18m
</code></pre><p>Cilium dapat digunakan sebagai kube-proxy, lihat <a href=https://docs.cilium.io/en/stable/gettingstarted/kubeproxy-free>Kubernetes tanpa kube-proxy</a>.</p>
<p>Untuk informasi lebih lanjut mengenai penggunaan Cilium dengan Kubernetes, lihat <a href=https://docs.cilium.io/en/stable/kubernetes/>panduan Instalasi Kubernetes untuk Cilium</a>.</p>
</div>
<div id=tabs-pod-install-2 class=tab-pane role=tabpanel aria-labelledby=tabs-pod-install-2>
<p><p><a href=https://contivpp.io/>Contiv-VPP</a> menggunakan CNF vSwitch berbasis <a href=https://fd.io/>FD.io VPP</a> yang dapat diprogram,
menawarkan layanan dan jejaring <em>cloud-native</em> yang memiliki banyak fungsi dan berkinerja tinggi.</p>
<p>Contiv-VPP mengimplementasikan Service dan Network Policy Kubernetes pada <em>user space</em> (on VPP).</p>
<p>Silakan merujuk pada panduan pemasangan berikut: <a href=https://github.com/contiv/vpp/blob/master/docs/setup/MANUAL_INSTALL.md>Pemasangan Manual Contiv-VPP</a></p>
</div>
<div id=tabs-pod-install-3 class=tab-pane role=tabpanel aria-labelledby=tabs-pod-install-3>
<p><p>Kube-router mengandalkan kube-controller-manager untuk mengalokasikan CIDR Pod untuk Node-Node. Maka dari itu, gunakan <code>kubeadm init</code> dengan opsi <code>--pod-network-cidr</code>.</p>
<p>Kube-router menyediakan jejaring Pod, <em>network policy</em>, dan IP Virtual Server(IPVS)/Linux Virtual Server(LVS) berbasis <em>service proxy</em> yang memiliki kinerja tinggi.</p>
<p>Informasi mengenai penggunaan <code>kubeadm</code> untuk mendirikan klaster Kubernetes dengan Kube-router, dapat dilihat di <a href=https://github.com/cloudnativelabs/kube-router/blob/master/docs/kubeadm.md>panduan pemasangan resminya</a>.</p>
</div>
<div id=tabs-pod-install-4 class=tab-pane role=tabpanel aria-labelledby=tabs-pod-install-4>
<p><p>Untuk informasi lebih lanjut mengenai pemasangan klaster Kubernetes menggunakan Weave Net, silakan lihat <a href=https://www.weave.works/docs/net/latest/kube-addon/>Mengintegrasikan Kubernetes melalui Addon</a>.</p>
<p>Weave Net bekerja pada platform <code>amd64</code>, <code>arm</code>, <code>arm64</code> dan <code>ppc64le</code> tanpa membutuhkan tindakan ekstra.
Weave Net menyalakan mode <em>hairpin</em> secara bawaan. Hal ini mengizinkan Pod untuk mengakses dirinya sendiri melalui alamat IP Service
jika mereka tidak tahu PodIP miliknya.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl apply -f <span style=color:#b44>&#34;https://cloud.weave.works/k8s/net?k8s-version=</span><span style=color:#a2f;font-weight:700>$(</span>kubectl version | base64 | tr -d <span style=color:#b44>&#39;\n&#39;</span><span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>&#34;</span>
</code></pre></div></div></div>
<p>Setelah jaringan Pod dipasangkan, kamu dapat mengonfirmasi hal tersebut dengan
memastikan Pod CoreDNS berada pada kondisi <code>Running</code> pada keluaran <code>kubectl get pods --all-namespaces</code>.
Dan setelah Pod CoreDNS sudah menyala dan berjalan, kamu dapat melanjutkan (pemasangan klaster) dengan menggabungkan Node-Node yang lain.</p>
<p>Jika jaringan belum bekerja atau CoreDNS tidak berada pada kondisi <code>Running</code>, periksalah/lihatlah
<a href=/docs/setup/production-environment/tools/kubeadm/troubleshooting-kubeadm/>panduan penyelesaian masalah</a>
untuk <code>kubeadm</code>.</p>
<h3 id=isolasi-node-control-plane>Isolasi Node <em>control plane</em></h3>
<p>Secara bawaan, klaster tidak akan menjadwalkan Pod pada Node <em>control-plane</em> untuk alasan
keamanan. Jika kamu ingin Pod dapat dijadwalkan pada Node <em>control-plane</em>, sebagai contoh untuk
klaster Kubernetes bermesin-tunggal untuk pengembangan, jalankan:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl taint nodes --all node-role.kubernetes.io/master-
</code></pre></div><p>Dengan keluaran seperti berikut:</p>
<pre><code>node &quot;test-01&quot; untainted
taint &quot;node-role.kubernetes.io/master:&quot; not found
taint &quot;node-role.kubernetes.io/master:&quot; not found
</code></pre><p>Hal ini akan menghapus <em>taint</em> <code>node-role.kubernetes.io/master</code> pada Node manapun yang
memilikinya, termasuk Node <em>control-plane</em>, sehingga <em>scheduler</em> akan dapat
menjadwalkan Pod di manapun.</p>
<h3 id=menggabungkan-node>Menggabungkan Node-Node</h3>
<p>Node adalah tempat beban kerja (Container, Pod, dan lain-lain) berjalan. Untuk menambahkan Node baru pada klaster lakukan hal berikut pada setiap mesin:</p>
<ul>
<li>SSH ke mesin</li>
<li>Gunakan pengguna <em>root</em> (mis. <code>sudo su -</code>)</li>
<li>Jalankan perintah hasil keluaran <code>kubeadm init</code>. Sebagai contoh:</li>
</ul>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubeadm join --token &lt;token&gt; &lt;control-plane-host&gt;:&lt;control-plane-port&gt; --discovery-token-ca-cert-hash sha256:&lt;hash&gt;
</code></pre></div><p>Jika kamu tidak memiliki <em>token</em>, kamu bisa mendapatkannya dengan menjalankan perintah berikut pada Node <em>control-plane</em>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubeadm token list
</code></pre></div><p>Keluarannya akan tampil seperti berikut:</p>
<pre><code class=language-console data-lang=console>TOKEN                    TTL  EXPIRES              USAGES           DESCRIPTION            EXTRA GROUPS
8ewj1p.9r9hcjoqgajrj4gi  23h  2018-06-12T02:51:28Z authentication,  The default bootstrap  system:
                                                   signing          token generated by     bootstrappers:
                                                                    'kubeadm init'.        kubeadm:
                                                                                           default-node-token
</code></pre><p>Secara bawaan, <em>token</em> akan kadaluarsa dalam 24 jam. Jika kamu menggabungkan Node ke klaster setelah <em>token</em> kadaluarsa,
kamu dapat membuat <em>token</em> baru dengan menjalankan perintah berikut pada Node <em>control-plane</em>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubeadm token create
</code></pre></div><p>Keluarannya akan tampil seperti berikut:</p>
<pre><code class=language-console data-lang=console>5didvk.d09sbcov8ph2amjw
</code></pre><p>Jika kamu tidak memiliki nilai <code>--discovery-token-ca-cert-hash</code>, kamu bisa mendapatkannya dengan menjalankan perintah berantai berikut pada Node <em>control-plane</em>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2&gt;/dev/null | <span style=color:#b62;font-weight:700>\
</span><span style=color:#b62;font-weight:700></span>   openssl dgst -sha256 -hex | sed <span style=color:#b44>&#39;s/^.* //&#39;</span>
</code></pre></div><p>Keluaran yang diberikan kurang lebih akan ditampilkan sebagai berikut:</p>
<pre><code class=language-console data-lang=console>8cb2de97839780a412b93877f8507ad6c94f73add17d5d7058e91741c9d5ec78
</code></pre><div class="alert alert-info note callout" role=alert>
<strong>Catatan:</strong> Untuk menentukan <em>tuple</em> IPv6 untuk <code>&lt;control-plane-host>:&lt;control-plane-port></code>, alamat IPv6 harus be ditutup dengan kurung siku, sebagai contoh: <code>[fd00::101]:2073</code>.
</div>
<p>Keluaran yang diberikan kurang lebih akan ditampilkan sebagai berikut:</p>
<pre><code>[preflight] Running pre-flight checks

... (log output of join workflow) ...

Node join complete:
* Certificate signing request sent to control-plane and response
  received.
* Kubelet informed of new secure connection details.

Run 'kubectl get nodes' on control-plane to see this machine join.
</code></pre><p>Beberapa saat kemudian, kamu akan melihat Node tersebut pada keluaran dari <code>kubectl get nodes</code> ketika dijalankan pada Node <em>control-plane</em>.</p>
<h3 id=opsional-mengendalikan-klaster-dari-mesin-selain-node-control-plane>(Opsional) Mengendalikan klaster dari mesin selain Node <em>control-plane</em></h3>
<p>Untuk membuat kubectl bekerja pada mesin lain (mis. laptop) agar dapat berbicara dengan
klaster, kamu harus menyalin berkas kubeconfig administrator dari Node <em>control-plane</em>
ke mesin seperti berikut:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>scp root@&lt;control-plane-host&gt;:/etc/kubernetes/admin.conf .
kubectl --kubeconfig ./admin.conf get nodes
</code></pre></div><div class="alert alert-info note callout" role=alert>
<strong>Catatan:</strong> <p>Contoh di atas mengasumsikan akses SSH dinyalakan untuk <em>root</em>. Jika tidak berlaku
demikian, kamu dapat menyalin berkas <code>admin.conf</code> untuk dapat diakses oleh pengguna lain
dan <code>scp</code> menggunakan pengguna lain tersebut.</p>
<p>Berkas <code>admin.conf</code> memberikan penggunanya privilese (<em>privilege</em>) <em>superuser</em> terhadap klaster.
Berkas ini harus digunakan seperlunya. Untuk pengguna biasa, direkomendasikan
untuk membuat kredensial unik dengan privilese <em>whitelist</em>. Kamu dapat melakukan
ini dengan perintah <code>kubeadm alpha kubeconfig user --client-name &lt;CN></code>.
Perintah tersebut akan mencetak berkas KubeConfig ke STDOUT yang harus kamu simpan
ke dalam sebuah berkas dan mendistribusikannya pada para pengguna. Setelah itu, whitelist
privilese menggunakan <code>kubectl create (cluster)rolebinding</code>.</p>
</div>
<h3 id=opsional-memproksi-api-server-ke-localhost>(Opsional) Memproksi API Server ke localhost</h3>
<p>Jika kamu ingin terhubung dengan API Server dari luar klaster kamu dapat menggunakan
<code>kubectl proxy</code>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>scp root@&lt;control-plane-host&gt;:/etc/kubernetes/admin.conf .
kubectl --kubeconfig ./admin.conf proxy
</code></pre></div><p>Kini kamu dapat mengakses API Server secara lokal melalui <code>http://localhost:8001/api/v1</code></p>
<h2 id=pembongkaran>Pembongkaran</h2>
<p>Jika kamu menggunakan server sekali pakai untuk membuat klaster, sebagai ujicoba, kamu dapat
mematikannya tanpa perlu melakukan pembongkaran. Kamu dapat menggunakan
<code>kubectl config delete-cluster</code> untuk menghapus referensi lokal ke
klaster.</p>
<p>Namun, jika kamu ingin mengatur ulang klaster secara lebih rapih, pertama-tama kamu
harus <a href=/docs/reference/generated/kubectl/kubectl-commands#drain>menguras (<em>drain</em>) Node</a>
dan memastikan Node sudah kosong, kemudian mengembalikan pengaturan pada Node kembali seperti semula.</p>
<h3 id=menghapus-node>Menghapus Node</h3>
<p>Berinteraksi dengan Node <em>control-plane</em> menggunakan kredensial yang sesuai, jalankan:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl drain &lt;node name&gt; --delete-local-data --force --ignore-daemonsets
kubectl delete node &lt;node name&gt;
</code></pre></div><p>Lalu, pada Node yang dihapus, atur ulang semua kondisi <code>kubeadm</code> yang telah dipasang:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubeadm reset
</code></pre></div><p>Proses pengaturan ulang tidak mengatur ulang atau membersihkan kebijakan iptables atau tabel IPVS. Jika kamu ingin mengatur ulang iptables, kamu harus melakukannya secara manual:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>iptables -F <span style=color:#666>&amp;&amp;</span> iptables -t nat -F <span style=color:#666>&amp;&amp;</span> iptables -t mangle -F <span style=color:#666>&amp;&amp;</span> iptables -X
</code></pre></div><p>Jika kamu ingin mengatur ulang tabel IPVS, kamu harus menjalankan perintah berikut:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ipvsadm -C
</code></pre></div><p>Jika kamu ingin mengulang dari awal, cukup jalankan <code>kubeadm init</code> atau <code>kubeadm join</code> dengan
argumen yang sesuai.</p>
<h3 id=membersihkan-control-plane>Membersihkan <em>control plane</em></h3>
<p>Kamu dapat menggunakan <code>kubeadm reset</code> pada hos <em>control plane</em> untuk memicu pembersihan
best-effort.</p>
<p>Lihat dokumentasi referensi <a href=/docs/reference/setup-tools/kubeadm/kubeadm-reset/><code>kubeadm reset</code></a>
untuk informasi lebih lanjut mengenai sub-perintah ini dan
opsinya.</p>
<h2 id=selanjutnya>Selanjutnya</h2>
<ul>
<li>Pastikan klaster berjalan dengan benar menggunakan <a href=https://github.com/heptio/sonobuoy>Sonobuoy</a></li>
<li><a id=lifecycle>Lihat <a href=/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/>Memperbaharui klaster kubeadm</a>
untuk detail mengenai pembaruan klaster menggunakan <code>kubeadm</code>.</li>
<li>Pelajari penggunaan <code>kubeadm</code> lebih lanjut pada <a href=/docs/reference/setup-tools/kubeadm>dokumentasi referensi kubeadm</a></li>
<li>Pelajari lebih lanjut mengenai <a href=/docs/concepts/>konsep-konsep</a> Kubernetes dan <a href=/docs/user-guide/kubectl-overview/><code>kubectl</code></a>.</li>
<li>Lihat halaman <a href=/id/docs/concepts/cluster-administration/networking/>Cluster Networking</a> untuk daftar
<em>add-on</em> jaringan Pod yang lebih banyak.</li>
<li><a id=other-addons>Lihat <a href=/id/docs/concepts/cluster-administration/addons/>daftar <em>add-on</em></a> untuk
mengeksplor <em>add-on</em> lainnya, termasuk perkakas untuk <em>logging</em>, <em>monitoring</em>, <em>network policy</em>, visualisasi &
pengendalian klaster Kubernetes.</li>
<li>Atur bagaimana klaster mengelola log untuk peristiwa-peristiwa klaster dan dari
aplikasi-aplikasi yang berjalan pada Pod.
Lihat <a href=/id/docs/concepts/cluster-administration/logging/>Arsitektur Logging</a> untuk
gambaran umum tentang hal-hal yang terlibat.</li>
</ul>
<h3 id=umpan-balik>Umpan balik</h3>
<ul>
<li>Untuk masalah kekutu (<em>bug</em>), kunjungi <a href=https://github.com/kubernetes/kubeadm/issues>kubeadm GitHub issue tracker</a></li>
<li>Untuk dukungan, kunjungi kanal Slack
<a href=https://kubernetes.slack.com/messages/kubeadm/>#kubeadm</a></li>
<li>Kanal Slack umum pengembangan SIG Cluster Lifecycle:
<a href=https://kubernetes.slack.com/messages/sig-cluster-lifecycle/>#sig-cluster-lifecycle</a></li>
<li>SIG Cluster Lifecycle <a href=https://github.com/kubernetes/community/tree/master/sig-cluster-lifecycle#readme>SIG information</a></li>
<li>Milis SIG Cluster Lifecycle:
<a href=https://groups.google.com/forum/#!forum/kubernetes-sig-cluster-lifecycle>kubernetes-sig-cluster-lifecycle</a></li>
</ul>
<h2 id=kebijakan-version-skew>Kebijakan <em>version skew</em></h2>
<p><code>kubeadm</code> versi v1.27 dapat men-<em>deploy</em> klaster dengan <em>control plane</em> versi v1.27 atau v1.26.
<code>kubeadm</code> v1.27 juga dapat memperbarui klaster yang dibuat dengan kubeadm v1.26.</p>
<p>Karena kita tidak dapat memprediksi masa depan, CLI kubeadm v1.27 mungkin atau tidak mungkin dapat men-<em>deploy</em> klaster v1.28.</p>
<p>Sumber daya ini menyediakan informasi lebih lanjut mengenai <em>version skew</em> yang didukung antara kubelet dan <em>control plane</em>, serta komponen Kubernetes lainnya:</p>
<ul>
<li><a href=/docs/setup/release/version-skew-policy/>Kebijakan versi and version-skew Kubernetes</a></li>
<li><a href=/id/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#installing-kubeadm-kubelet-and-kubectl>Panduan instalasi</a> spesifik untuk kubeadm</li>
</ul>
<h2 id=keterbatasan>Keterbatasan</h2>
<h3 id=ketahanan-klaster>Ketahanan klaster</h3>
<p>Klaster yang dibuat pada panduan ini hanya memiliki Node <em>control-plane</em> tunggal, dengan basis data etcd tunggal
yang berjalan di atasnya. Hal ini berarti jika terjadi kegagalan pada Node <em>control-plane</em>, klaster dapat kehilangan
data dan mungkin harus dibuat kembali dari awal.</p>
<p>Solusi:</p>
<ul>
<li>
<p>Lakukan <a href=https://coreos.com/etcd/docs/latest/admin_guide.html>back up etcd</a> secara reguler. Direktori data
etcd yang dikonfigurasi oleh kubeadm berada di <code>/var/lib/etcd</code> pada Node <em>control-plane</em>.</p>
</li>
<li>
<p>Gunakan banyak Node <em>control-plane</em>. Kamu dapat membaca
<a href=/docs/setup/production-environment/tools/kubeadm/ha-topology/>Opsi untuk topologi dengan ketersediaan tinggi</a> untuk memilih topologi
klaster yang menyediakan ketersediaan lebih tinggi.</p>
</li>
</ul>
<h3 id=kompatibilitas-platform>Kompatibilitas platform</h3>
<p><em>Package</em> dbm/rpm dan <em>binary</em> kubeadm dibuat untuk amd64, arm (32-bit), arm64, ppc64le, dan s390x
mengikuti <a href=https://github.com/kubernetes/community/blob/master/contributors/design-proposals/multi-platform.md>proposal multi-platform</a>.</p>
<p><em>Image</em> kontainer <em>multiplatform</em> untuk <em>control plane</em> dan <em>addon</em> juga telah didukung sejak v1.12.</p>
<p>Hanya beberapa penyedia jaringan yang menawarkan solusi untuk seluruh platform. Silakan merujuk pada daftar
penyedia jaringan di atas atau dokumentasi dari masing-masing penyedia untuk mencari tahu apakah penyedia tersebut
mendukung platform pilihanmu.</p>
<h2 id=penyelesaian-masalah>Penyelesaian masalah</h2>
<p>Jika kamu menemui kesulitan dengan kubeadm, silakan merujuk pada <a href=/docs/setup/production-environment/tools/kubeadm/troubleshooting-kubeadm/>dokumen penyelesaian masalah</a>.</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-3941d5c3409342219bf7e03128b8ecb6>1.3 - Membangun Klaster dengan Ketersediaan Tinggi menggunakan kubeadm</h1>
<p>Laman ini menjelaskan dua pendekatan yang berbeda untuk membuat klaster Kubernetes dengan ketersediaan tinggi menggunakan kubeadm:</p>
<ul>
<li>Dengan Node <em>control plane</em> yang bertumpuk (<em>stacked</em>). Pendekatan ini membutuhkan sumber daya infrastruktur yang lebih sedikit. Anggota-anggota etcd dan Node <em>control plane</em> diletakkan pada tempat yang sama (<em>co-located</em>).</li>
<li>Dengan klaster etcd eksternal. Pendekatan ini membutuhkan lebih banyak sumber daya infrastruktur. Node <em>control plane</em> dan anggota etcd berada pada tempat yang berbeda.</li>
</ul>
<p>Sebelum memulai, kamu harus memikirkan dengan matang pendekatan mana yang paling sesuai untuk kebutuhan aplikasi dan <em>environment</em>-mu. <a href=/id/docs/setup/production-environment/tools/kubeadm/ha-topology/>Topik perbandingan berikut</a> menguraikan kelebihan dan kekurangan dari masing-masing pendekatan.</p>
<p>Jika kamu menghadapi masalah dalam pembuatan klaster dengan ketersediaan tinggi, silakan berikan umpan balik
pada <a href=https://github.com/kubernetes/kubeadm/issues/new>pelacak isu</a> kubeadm.</p>
<p>Lihat juga <a href=/id/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade-1-15>dokumentasi pembaruan</a>.</p>
<div class="alert alert-warning caution callout" role=alert>
<strong>Perhatian:</strong> Laman ini tidak menunjukkan cara untuk menjalankan klastermu pada penyedia layanan cloud. Pada <em>environment</em> cloud, kedua pendekatan yang didokumentasikan di sini tidak akan bekerja untuk objek Service dengan tipe LoadBalancer maupun PersistentVolume dinamis.
</div>
<h2 id=sebelum-kamu-memulai>Sebelum kamu memulai</h2>
<p>Untuk kedua metode kamu membutuhkan infrastruktur seperti berikut:</p>
<ul>
<li>Tiga mesin yang memenuhi <a href=/id/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#sebelum-mulai>kebutuhan minimum kubeadm</a> untuk
Node <em>control plane</em></li>
<li>Tiga mesin yang memenuhi <a href=/id/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#sebelum-mulai>kebutuhan minimum kubeadm</a> untuk Node <em>worker</em></li>
<li>Konektivitas internet pada seluruh mesin di dalam klaster (baik jaringan publik maupun jaringan pribadi)</li>
<li>Hak akses sudo pada seluruh mesin</li>
<li>Akses SSH dari satu perangkat ke seluruh Node pada sistem</li>
<li>Perkakas <code>kubeadm</code> dan <code>kubelet</code> diinstal pada seluruh mesin. Perkakas <code>kubectl</code> bersifat opsional.</li>
</ul>
<p>Untuk klaster etcd eksternal saja, kamu juga membutuhkan:</p>
<ul>
<li>Tiga mesin tambahan untuk anggota-anggota etcd</li>
</ul>
<h2 id=langkah-pertama-untuk-kedua-metode>Langkah pertama untuk kedua metode</h2>
<h3 id=membuat-load-balancer-untuk-kube-apiserver>Membuat <em>load balancer</em> untuk kube-apiserver</h3>
<div class="alert alert-info note callout" role=alert>
<strong>Catatan:</strong> Akan ada banyak konfigurasi untuk <em>load balancer</em>. Contoh berikut ini hanyalah salah satu
opsi. Kebutuhan klastermu mungkin membutuhkan konfigurasi berbeda.
</div>
<ol>
<li>
<p>Buat sebuah <em>load balancer</em> kube-apiserver dengan sebuah nama yang yang akan mengubah ke dalam bentuk DNS.</p>
<ul>
<li>
<p>Pada <em>environment</em> cloud kamu harus meletakkan Node <em>control plane</em> di belakang <em>load balancer</em> yang meneruskan TCP. <em>Load balancer</em> ini mendistribusikan trafik ke seluruh Node <em>control plane</em> pada daftar tujuan. <em>Health check</em> untuk
apiserver adalah pengujian TCP pada porta yang didengarkan oleh kube-apiserver
(nilai semula <code>:6443</code>).</p>
</li>
<li>
<p>Tidak direkomendasikan untuk menggunakan alamat IP secara langsung pada <em>environment</em> cloud.</p>
</li>
<li>
<p><em>Load balancer</em> harus dapat berkomunikasi dengan seluruh Node <em>control plane</em>
pada porta yang digunakan apiserver. <em>Load balancer</em> tersebut juga harus mengizinkan trafik masuk pada porta yang didengarkannya.</p>
</li>
<li>
<p>Pastikan alamat <em>load balancer</em> sesuai
dengan alamat <code>ControlPlaneEndpoint</code> pada kubeadm.</p>
</li>
<li>
<p>Baca panduan <a href=https://github.com/kubernetes/kubeadm/blob/master/id/docs/ha-considerations.md#options-for-software-load-balancing>Opsi untuk <em>Software Load Balancing</em></a>
untuk detail lebih lanjut.</p>
</li>
</ul>
</li>
<li>
<p>Tambahkan Node <em>control plane</em> pertama pada <em>load balancer</em> dan lakukan pengujian koneksi:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nc -v LOAD_BALANCER_IP PORT
</code></pre></div><ul>
<li>Kegalatan koneksi yang ditolak memang diantisipasi karena apiserver belum
berjalan. Namun jika mendapat <em>timeout</em>, berarti <em>load balancer</em> tidak dapat berkomunikasi
dengan Node <em>control plane</em>. Jika terjadi <em>timeout</em>, lakukan pengaturan ulang pada <em>load balancer</em> agar dapat berkomunikasi dengan Node <em>control plane</em>.</li>
</ul>
</li>
<li>
<p>Tambahkan Node <em>control plane</em> lainnya pada grup tujuan <em>load balancer</em>.</p>
</li>
</ol>
<h2 id=node-control-plane-dan-etcd-bertumpuk-stacked>Node <em>control plane</em> dan etcd bertumpuk (<em>stacked</em>)</h2>
<h3 id=langkah-langkah-untuk-node-control-plane-pertama>Langkah-langkah untuk Node <em>control plane</em> pertama</h3>
<ol>
<li>
<p>Inisialisasi <em>control plane</em>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo kubeadm init --control-plane-endpoint <span style=color:#b44>&#34;LOAD_BALANCER_DNS:LOAD_BALANCER_PORT&#34;</span> --upload-certs
</code></pre></div><ul>
<li>
<p>Kamu bisa menggunakan opsi <code>--kubernetes-version</code> untuk mengatur versi Kubernetes yang akan digunakan.
Direkomendasikan untuk menggunakan versi kubeadm, kubelet, kubectl, dan Kubernetes yang sama.</p>
</li>
<li>
<p>Opsi <code>--control-plane-endpoint</code> harus diatur menuju alamat atau DNS dan porta dari <em>load balancer</em>.</p>
</li>
<li>
<p>Opsi <code>--upload-certs</code> digunakan untuk mengunggah sertifikat-sertifikat yang harus dibagikan ke seluruh
Node <em>control plane</em> pada klaster. Jika sebaliknya, kamu memilih untuk menyalin sertifikat ke
seluruh Node <em>control plane</em> sendiri atau menggunakan perkakas automasi, silakan hapus opsi ini dan merujuk ke bagian <a href=#distribusi-sertifikat-manual>Distribusi sertifikat manual</a> di bawah.</p>
</li>
</ul>
<div class="alert alert-info note callout" role=alert>
<strong>Catatan:</strong> Opsi <code>--config</code> dan <code>--certificate-key</code> pada <code>kubeadm init</code> tidak dapat digunakan secara bersamaan, maka dari itu jika kamu ingin menggunakan
<a href=https://godoc.org/k8s.io/kubernetes/cmd/kubeadm/app/apis/kubeadm/v1beta2>konfigurasi kubeadm</a>
kamu harus menambahkan <em>field</em> <code>certificateKey</code> pada lokasi pengaturan yang sesuai
(berada di bawah <code>InitConfiguration</code> dan <code>JoinConfiguration: controlPlane</code>).
</div>
<div class="alert alert-info note callout" role=alert>
<strong>Catatan:</strong> Beberapa <em>plugin</em> jaringan CNI membutuhkan pengaturan tambahan, seperti menentukan CIDR IP untuk Pod, meski beberapa lainnya tidak.
Lihat <a href=/id/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#jaringan-pod>dokumentasi jaringan CNI</a>.
Untuk menambahkan CIDR Pod, tambahkan opsi <code>--pod-network-cidr</code>, atau jika kamu menggunakan berkas konfigurasi kubeadm
pasang <em>field</em> <code>podSubnet</code> di bawah objek <code>networking</code> dari <code>ClusterConfiguration</code>.
</div>
<ul>
<li>
<p>Keluaran yang dihasilkan terlihat seperti berikut ini:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>...
You can now join any number of control-plane node by running the following <span style=color:#a2f>command</span> on each as a root:
    kubeadm join 192.168.0.200:6443 --token 9vr73a.a8uxyaju799qwdjv --discovery-token-ca-cert-hash sha256:7c2e69131a36ae2a042a339b33381c6d0d43887e2de83720eff5359e26aec866 --control-plane --certificate-key f8902e114ef118304e561c3ecd4d0b543adc226b7a07f675f56564185ffe0c07

Please note that the certificate-key gives access to cluster sensitive data, keep it secret!
As a safeguard, uploaded-certs will be deleted in two hours; If necessary, you can use kubeadm init phase upload-certs to reload certs afterward.

Then you can join any number of worker nodes by running the following on each as root:
    kubeadm join 192.168.0.200:6443 --token 9vr73a.a8uxyaju799qwdjv --discovery-token-ca-cert-hash sha256:7c2e69131a36ae2a042a339b33381c6d0d43887e2de83720eff5359e26aec866
</code></pre></div></li>
<li>
<p>Salin keluaran ini pada sebuah berkas teks. Kamu akan membutuhkannya nanti untuk menggabungkan Node <em>control plane</em> dan <em>worker</em> ke klaster.</p>
</li>
<li>
<p>Ketika opsi <code>--upload-certs</code> digunakan dengan <code>kubeadm init</code>, sertifikat dari <em>control plane</em> utama
akan dienkripsi dan diunggah ke Secret <code>kubeadm-certs</code>.</p>
</li>
<li>
<p>Untuk mengunggah ulang sertifikat dan membuat kunci dekripsi baru, gunakan perintah berikut pada Node <em>control plane</em>
yang sudah tergabung pada klaster:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo kubeadm init phase upload-certs --upload-certs
</code></pre></div></li>
<li>
<p>Kamu juga dapat menentukan <code>--certificate-key</code> <em>custom</em> pada saat <code>init</code> yang nanti dapat digunakan pada saat <code>join</code>.
Untuk membuat kunci tersebut kamu dapat menggunakan perintah berikut:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>kubeadm alpha certs certificate-key
</code></pre></div></li>
</ul>
<div class="alert alert-info note callout" role=alert>
<strong>Catatan:</strong> Secret <code>kubeadm-certs</code> dan kunci dekripsi akan kadaluarsa setelah dua jam.
</div>
<div class="alert alert-warning caution callout" role=alert>
<strong>Perhatian:</strong> Seperti yang tertera pada keluaran perintah, kunci sertifikat memberikan akses ke data klaster yang bersifat sensitif, jaga kerahasiaannya!
</div>
</li>
<li>
<p>Pasang <em>plugin</em> CNI pilihanmu:
<a href=/id/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#jaringan-pod>Ikuti petunjuk berikut</a>
untuk menginstal penyedia CNI. Pastikan konfigurasinya sesuai dengan CIDR Pod yang ditentukan pada berkas konfigurasi kubeadm jika diterapkan.</p>
<p>Pada contoh berikut kami menggunakan Weave Net:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>kubectl apply -f <span style=color:#b44>&#34;https://cloud.weave.works/k8s/net?k8s-version=</span><span style=color:#a2f;font-weight:700>$(</span>kubectl version | base64 | tr -d <span style=color:#b44>&#39;\n&#39;</span><span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>&#34;</span>
</code></pre></div></li>
<li>
<p>Tulis perintah berikut dan saksikan Pod komponen-komponen <em>control plane</em> mulai dinyalakan:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>kubectl get pod -n kube-system -w
</code></pre></div></li>
</ol>
<h3 id=langkah-langkah-selanjutnya-untuk-node-control-plane>Langkah-langkah selanjutnya untuk Node <em>control plane</em></h3>
<div class="alert alert-info note callout" role=alert>
<strong>Catatan:</strong> Sejak kubeadm versi 1.15 kamu dapat menggabungkan beberapa Node <em>control plane</em> secara bersamaan.
Pada versi sebelumnya, kamu harus menggabungkan Node <em>control plane</em> baru secara berurutan, setelah
Node pertama selesai diinisialisasi.
</div>
<p>Untuk setiap Node <em>control plane</em> kamu harus:</p>
<ol>
<li>
<p>Mengeksekusi perintah untuk bergabung yang sebelumnya diberikan pada keluaran <code>kubeadm init</code> pada Node pertama.
Perintah tersebut terlihat seperti ini:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo kubeadm join 192.168.0.200:6443 --token 9vr73a.a8uxyaju799qwdjv --discovery-token-ca-cert-hash sha256:7c2e69131a36ae2a042a339b33381c6d0d43887e2de83720eff5359e26aec866 --control-plane --certificate-key f8902e114ef118304e561c3ecd4d0b543adc226b7a07f675f56564185ffe0c07
</code></pre></div><ul>
<li>Opsi <code>--control-plane</code> menunjukkan <code>kubeadm join</code> untuk membuat <em>control plane</em> baru.</li>
<li>Opsi <code>--certificate-key ...</code> akan membuat sertifikat <em>control plane</em> diunduh
dari Secret <code>kubeadm-certs</code> pada klaster dan didekripsi menggunakan kunci yang diberikan.</li>
</ul>
</li>
</ol>
<h2 id=node-etcd-eksternal>Node etcd eksternal</h2>
<p>Membangun sebuah klaster dengan Node etcd eksternal memiliki prosedur yang mirip dengan etcd bertumpuk
dengan pengecualian yaitu kamu harus setup etcd terlebih dulu, dan kamu harus memberikan informasi etcd
pada berkas konfigurasi kubeadm.</p>
<h3 id=memasang-klaster-etcd>Memasang klaster etcd</h3>
<ol>
<li>
<p>Ikuti <a href=/docs/setup/production-environment/tools/kubeadm/setup-ha-etcd-with-kubeadm/>petunjuk berikut</a> untuk membangun klaster etcd.</p>
</li>
<li>
<p>Lakukan pengaturan SSH seperti yang dijelaskan <a href=#distribusi-sertifikat-manual>di sini</a>.</p>
</li>
<li>
<p>Salin berkas-berkas berikut dari Node etcd manapun pada klaster ke Node <em>control plane</em> pertama:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#a2f>export</span> <span style=color:#b8860b>CONTROL_PLANE</span><span style=color:#666>=</span><span style=color:#b44>&#34;ubuntu@10.0.0.7&#34;</span>
scp /etc/kubernetes/pki/etcd/ca.crt <span style=color:#b44>&#34;</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>CONTROL_PLANE</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#34;</span>:
scp /etc/kubernetes/pki/apiserver-etcd-client.crt <span style=color:#b44>&#34;</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>CONTROL_PLANE</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#34;</span>:
scp /etc/kubernetes/pki/apiserver-etcd-client.key <span style=color:#b44>&#34;</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>CONTROL_PLANE</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#34;</span>:
</code></pre></div><ul>
<li>Ganti nilai <code>CONTROL_PLANE</code> dengan <code>user@host</code> dari mesin <em>control plane</em> pertama.</li>
</ul>
</li>
</ol>
<h3 id=mengatur-node-control-plane-pertama>Mengatur Node <em>control plane</em> pertama</h3>
<ol>
<li>
<p>Buat sebuah berkas bernama <code>kubeadm-config.yaml</code> dengan konten sebagai berikut:</p>
<pre><code>apiVersion: kubeadm.k8s.io/v1beta2
kind: ClusterConfiguration
kubernetesVersion: stable
controlPlaneEndpoint: &quot;LOAD_BALANCER_DNS:LOAD_BALANCER_PORT&quot;
etcd:
    external:
        endpoints:
        - https://ETCD_0_IP:2379
        - https://ETCD_1_IP:2379
        - https://ETCD_2_IP:2379
        caFile: /etc/kubernetes/pki/etcd/ca.crt
        certFile: /etc/kubernetes/pki/apiserver-etcd-client.crt
        keyFile: /etc/kubernetes/pki/apiserver-etcd-client.key
</code></pre>
</li>
</ol>
<div class="alert alert-info note callout" role=alert>
<strong>Catatan:</strong> Perbedaan antara etcd bertumpuk dan etcd eksternal yaitu etcd eksternal membutuhkan
sebuah berkas konfigurasi dengan <em>endpoint</em> etcd di bawah objek <code>external</code>untuk <code>etcd</code>.
Pada kasus ini topologi etcd bertumpuk dikelola secara otomatis.
</div>
<ul>
<li>Ganti variabel-variabel berikut pada templat konfigurasi dengan nilai yang sesuai untuk klastermu:</li>
</ul>
<pre><code>- `LOAD_BALANCER_DNS`
- `LOAD_BALANCER_PORT`
- `ETCD_0_IP`
- `ETCD_1_IP`
- `ETCD_2_IP`
</code></pre>
<p>Langkah-langkah berikut sama dengan pengaturan pada etcd bertumpuk:</p>
<ol>
<li>
<p>Jalankan <code>sudo kubeadm init --config kubeadm-config.yaml --upload-certs</code> pada Node ini.</p>
</li>
<li>
<p>Tulis perintah untuk bergabung yang didapat dari keluaran ke dalam sebuah berkas teks untuk digunakan nanti.</p>
</li>
<li>
<p>Pasang <em>plugin</em> CNI pilihanmu. Contoh berikut ini untuk Weave Net:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>kubectl apply -f <span style=color:#b44>&#34;https://cloud.weave.works/k8s/net?k8s-version=</span><span style=color:#a2f;font-weight:700>$(</span>kubectl version | base64 | tr -d <span style=color:#b44>&#39;\n&#39;</span><span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>&#34;</span>
</code></pre></div></li>
</ol>
<h3 id=langkah-selanjutnya-untuk-node-control-plane-lainnya>Langkah selanjutnya untuk Node <em>control plane</em> lainnya</h3>
<p>Langkah-langkah selanjutnya sama untuk pengaturan etcd bertumpuk:</p>
<ul>
<li>Pastikan Node <em>control plane</em> pertama sudah diinisialisasi dengan sempurna.</li>
<li>Gabungkan setiap Node <em>control plane</em> dengan perintah untuk bergabung yang kamu simpan dalam berkas teks. Direkomendasikan untuk
menggabungkan Node <em>control plane</em> satu persatu.</li>
<li>Jangan lupakan bahwa kunci dekripsi dari <code>--certificate-key</code> akan kadaluarsa setelah dua jam, pada pengaturan semula.</li>
</ul>
<h2 id=tugas-tugas-umum-setelah-menyiapkan-control-plane>Tugas-tugas umum setelah menyiapkan <em>control plane</em></h2>
<h3 id=menginstal-worker>Menginstal <em>worker</em></h3>
<p>Node <em>worker</em> bisa digabungkan ke klaster menggunakan perintah yang kamu simpan sebelumnya
dari keluaran perintah <code>kubeadm init</code>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo kubeadm join 192.168.0.200:6443 --token 9vr73a.a8uxyaju799qwdjv --discovery-token-ca-cert-hash sha256:7c2e69131a36ae2a042a339b33381c6d0d43887e2de83720eff5359e26aec866
</code></pre></div><h2 id=distribusi-sertifikat-manual>Distribusi sertifikat manual</h2>
<p>Jika kamu memilih untuk tidak menggunakan <code>kubeadm init</code> dengan opsi <code>--upload-certs</code> berarti kamu harus
menyalin sertifikat dari Node <em>control plane</em> utama secara manual ke
Node <em>control plane</em> yang akan bergabung.</p>
<p>Ada beberapa cara untuk melakukan hal ini. Pada contoh berikut ini kami menggunakan <code>ssh</code> dan <code>scp</code>:</p>
<p>SSH dibutuhkan jika kamu ingin mengendalikan seluruh Node dari satu mesin.</p>
<ol>
<li>
<p>Nyalakan ssh-agent pada perangkat utamamu yang memiliki akses ke seluruh Node pada
sistem:</p>
<pre><code>eval $(ssh-agent)
</code></pre></li>
<li>
<p>Tambahkan identitas SSH milikmu ke dalam sesi:</p>
<pre><code>ssh-add ~/.ssh/path_to_private_key
</code></pre></li>
<li>
<p>Lakukan SSH secara bergantian ke setiap Node untuk memastikan koneksi bekerja dengan baik.</p>
<ul>
<li>
<p>Ketika kamu melakukan SSH ke Node, pastikan untuk menambahkan opsi <code>-A</code>:</p>
<pre><code>ssh -A 10.0.0.7
</code></pre></li>
<li>
<p>Jika kamu menggunakan sudo pada Node, pastikan kamu menyimpan <em>environment</em> yang ada sehingga penerusan SSH
dapat bekerja dengan baik:</p>
<pre><code>sudo -E -s
</code></pre></li>
</ul>
</li>
<li>
<p>Setelah mengatur SSH pada seluruh Node kamu harus menjalankan skrip berikut pada Node <em>control plane</em> pertama setelah
menjalankan <code>kubeadm init</code>. Skrip ini akan menyalin sertifikat dari Node <em>control plane</em> pertama ke Node
<em>control plane</em> lainnya:</p>
<p>Pada contoh berikut, ganti <code>CONTROL_PLANE_IPS</code> dengan alamat IP dari
Node <em>control plane</em> lainnya.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#b8860b>USER</span><span style=color:#666>=</span>ubuntu <span style=color:#080;font-style:italic># dapat disesuaikan</span>
<span style=color:#b8860b>CONTROL_PLANE_IPS</span><span style=color:#666>=</span><span style=color:#b44>&#34;10.0.0.7 10.0.0.8&#34;</span>
<span style=color:#a2f;font-weight:700>for</span> host in <span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>CONTROL_PLANE_IPS</span><span style=color:#b68;font-weight:700>}</span>; <span style=color:#a2f;font-weight:700>do</span>
    scp /etc/kubernetes/pki/ca.crt <span style=color:#b44>&#34;</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#34;</span>@<span style=color:#b8860b>$host</span>:
    scp /etc/kubernetes/pki/ca.key <span style=color:#b44>&#34;</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#34;</span>@<span style=color:#b8860b>$host</span>:
    scp /etc/kubernetes/pki/sa.key <span style=color:#b44>&#34;</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#34;</span>@<span style=color:#b8860b>$host</span>:
    scp /etc/kubernetes/pki/sa.pub <span style=color:#b44>&#34;</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#34;</span>@<span style=color:#b8860b>$host</span>:
    scp /etc/kubernetes/pki/front-proxy-ca.crt <span style=color:#b44>&#34;</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#34;</span>@<span style=color:#b8860b>$host</span>:
    scp /etc/kubernetes/pki/front-proxy-ca.key <span style=color:#b44>&#34;</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#34;</span>@<span style=color:#b8860b>$host</span>:
    scp /etc/kubernetes/pki/etcd/ca.crt <span style=color:#b44>&#34;</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#34;</span>@<span style=color:#b8860b>$host</span>:etcd-ca.crt
    <span style=color:#080;font-style:italic># Kutip baris berikut jika kamu menggunakan etcd eksternal</span>
    scp /etc/kubernetes/pki/etcd/ca.key <span style=color:#b44>&#34;</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>&#34;</span>@<span style=color:#b8860b>$host</span>:etcd-ca.key
<span style=color:#a2f;font-weight:700>done</span>
</code></pre></div><div class="alert alert-warning caution callout" role=alert>
<strong>Perhatian:</strong> Salinlah hanya sertifikat yang berada pada daftar di atas saja. Perkakas kubeadm akan mengambil alih pembuatan sertifikat lainnya
dengan SANs yang dibutuhkan untuk Node <em>control plane</em> yang akan bergabung. Jika kamu menyalin seluruh sertifikat tanpa sengaja,
pembuatan Node tambahan dapat gagal akibat tidak adanya SANs yang dibutuhkan.
</div>
</li>
<li>
<p>Lalu, pada setiap Node <em>control plane</em> yang bergabung kamu harus menjalankan skrip berikut sebelum menjalankan <code>kubeadm join</code>.
Skrip ini akan memindahkan sertifikat yang telah disalin sebelumnya dari direktori <em>home</em> ke <code>/etc/kubernetes/pki</code>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#b8860b>USER</span><span style=color:#666>=</span>ubuntu <span style=color:#080;font-style:italic># dapat disesuaikan</span>
mkdir -p /etc/kubernetes/pki/etcd
mv /home/<span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span>/ca.crt /etc/kubernetes/pki/
mv /home/<span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span>/ca.key /etc/kubernetes/pki/
mv /home/<span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span>/sa.pub /etc/kubernetes/pki/
mv /home/<span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span>/sa.key /etc/kubernetes/pki/
mv /home/<span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span>/front-proxy-ca.crt /etc/kubernetes/pki/
mv /home/<span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span>/front-proxy-ca.key /etc/kubernetes/pki/
mv /home/<span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span>/etcd-ca.crt /etc/kubernetes/pki/etcd/ca.crt
<span style=color:#080;font-style:italic># Kutip baris berikut jika kamu menggunakan etcd eksternal</span>
mv /home/<span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>USER</span><span style=color:#b68;font-weight:700>}</span>/etcd-ca.key /etc/kubernetes/pki/etcd/ca.key
</code></pre></div></li>
</ol>
</div>
</main>
</div>
</div>
<footer class=d-print-none>
<div class=footer__links>
<nav>
<a class=text-white href=/id/docs/home/>Home</a>
<a class=text-white href=/id/community/>Komunitas</a>
<a class=text-white href=/id/case-studies/>Studi kasus</a>
</nav>
</div>
<div class=container-fluid>
<div class=row>
<div class="col-6 col-sm-2 text-xs-center order-sm-2">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list">
<a class=text-white target=_blank href=https://discuss.kubernetes.io>
<i class="fa fa-envelope"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter>
<a class=text-white target=_blank href=https://twitter.com/kubernetesio>
<i class="fab fa-twitter"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Calendar aria-label=Calendar>
<a class=text-white target=_blank href="https://calendar.google.com/calendar/embed?src=calendar%40kubernetes.io">
<i class="fas fa-calendar-alt"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube>
<a class=text-white target=_blank href=https://youtube.com/kubernetescommunity>
<i class="fab fa-youtube"></i>
</a>
</li>
</ul>
</div>
<div class="col-6 col-sm-2 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank href=https://github.com/kubernetes/kubernetes>
<i class="fab fa-github"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack>
<a class=text-white target=_blank href=https://slack.k8s.io>
<i class="fab fa-slack"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Contribute aria-label=Contribute>
<a class=text-white target=_blank href=https://git.k8s.io/community/contributors/guide>
<i class="fas fa-edit"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow">
<a class=text-white target=_blank href=https://stackoverflow.com/questions/tagged/kubernetes>
<i class="fab fa-stack-overflow"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-8 text-center order-sm-2">
<small class=text-white>&copy; 2023 Para Pencipta Kubernetes | Dokumentasi didistribusikan di bawah <a href=https://git.k8s.io/website/LICENSE class=light-text>CC BY 4.0</a></small>
<br>
<small class=text-white>Copyright &copy; 2023 Linux Foundation &reg;. Hak cipta dilindungi. Linux Foundation telah mendaftarkan merek dagang dan pengunaannya. Perinciannya bisa dilihat pada <a href=https://www.linuxfoundation.org/trademark-usage class=light-text>halaman penggunaan merek dagang</a></small>
<br>
<small class=text-white>ICP license: 京ICP备17074266号-3</small>
</div>
</div>
</div>
</footer>
</div>
<script src=/js/popper-1.14.3.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script>
<script src=/js/bootstrap-4.3.1.min.js integrity=sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM crossorigin=anonymous></script>
<script src=/js/main.min.40616251a9b6e4b689e7769be0340661efa4d7ebb73f957404e963e135b4ed52.js integrity="sha256-QGFiUam25LaJ53ab4DQGYe+k1+u3P5V0BOlj4TW07VI=" crossorigin=anonymous></script>
</body>
</html>